[2025-09-26T13:36:55.575Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:28f89b65-4f27-468c-a84a-e8cada9e1395",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T13:36:55.573Z",
    "time": "10:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:36:57.211Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:26:13.022Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:28f89b65-4f27-468c-a84a-e8cada9e1395",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T13:36:55.573Z",
    "time": "10:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:36:57.212Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:26:13.022Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:28f89b65-4f27-468c-a84a-e8cada9e1395",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-26T13:36:55.573Z",
      "time": "10:36 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:36:57.212Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-26T13:36:57.543Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:36:57.553Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:36:58.114Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {},
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:36:58.118Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:37:01.384Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesito que me proporciones las siguientes informaciones: la fecha de check-in, la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¡Gracias!",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T13:37:01.385Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:01.385Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:01.385Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:37:01.386Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "c2db0c1e-a4aa-4976-ab4a-61a63171e82f",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:37:01.385Z",
  "time": "10:36 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:37:01.586Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T13:37:10.804Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bc098063-74c0-43f9-9365-2cb273dd9885",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T13:37:10.804Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:37:12.146Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T13:36:57.939Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:36:56.131Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bc098063-74c0-43f9-9365-2cb273dd9885",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T13:37:10.804Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:37:12.147Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T13:36:57.939Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:36:56.131Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bc098063-74c0-43f9-9365-2cb273dd9885",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-26T13:37:10.804Z",
      "time": "10:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:37:12.147Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-26T13:37:12.151Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:12.152Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T13:37:12.157Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:12.675Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:37:12.677Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:37:15.670Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si estás interesado en realizar una reserva, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T13:37:15.670Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:15.671Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:15.671Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:37:15.671Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "7b102f6d-7d32-482d-83c7-b456a5dbb339",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:37:15.671Z",
  "time": "10:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:37:15.844Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T13:37:54.526Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:a5bd7798-ace3-4296-bda8-41ef403ec770",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T13:37:54.525Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:37:55.925Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T13:37:12.494Z",
    "updatedBy": "ai",
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:37:11.297Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:a5bd7798-ace3-4296-bda8-41ef403ec770",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T13:37:54.525Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:37:55.926Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T13:37:12.494Z",
      "updatedBy": "ai",
      "reservationSlots": {
        "guestName": "Marcelo Martinez"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:37:11.297Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:a5bd7798-ace3-4296-bda8-41ef403ec770",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-26T13:37:54.525Z",
      "time": "10:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:37:55.927Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-26T13:37:55.934Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:55.935Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T13:37:55.939Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:37:56.450Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:37:56.453Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:38:00.176Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesitaría que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes que se alojarán. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "guests": null,
    "checkin_date": null,
    "checkout_date": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, y cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-26T13:38:00.177Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:38:00.177Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:38:00.178Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:38:00.178Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "e6e923f9-6cb0-4cca-b195-e3a58a2e56d7",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:38:00.178Z",
  "time": "10:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:38:00.369Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T13:57:04.298Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d5271cfa-ca16-4a60-8618-3f112b00fb94",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T13:57:04.295Z",
    "time": "10:57 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:57:06.308Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:37:55.048Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d5271cfa-ca16-4a60-8618-3f112b00fb94",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T13:57:04.295Z",
    "time": "10:57 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:57:06.309Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:37:55.048Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d5271cfa-ca16-4a60-8618-3f112b00fb94",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-26T13:57:04.295Z",
      "time": "10:57 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:57:06.310Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-26T13:57:06.644Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:57:06.651Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:57:07.246Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {},
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:57:07.251Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:57:10.289Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesitaría que me proporciones las siguientes informaciones: las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T13:57:10.289Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:57:10.289Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:57:10.290Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:57:10.290Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "02b37fe9-d6dc-4a90-b183-86e5d4a45f93",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:57:10.290Z",
  "time": "10:57 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:57:10.460Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T13:58:28.108Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8b754a5b-5352-4fb4-bf78-50d0119e5136",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T13:58:28.108Z",
    "time": "10:58 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:58:29.491Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T13:57:07.037Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:57:05.113Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8b754a5b-5352-4fb4-bf78-50d0119e5136",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T13:58:28.108Z",
    "time": "10:58 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:58:29.492Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T13:57:07.037Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:57:05.113Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8b754a5b-5352-4fb4-bf78-50d0119e5136",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-26T13:58:28.108Z",
      "time": "10:58 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:58:29.492Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-26T13:58:29.496Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:58:29.497Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T13:58:29.499Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:58:30.001Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:58:30.003Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:58:33.201Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-26T13:58:33.202Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:58:33.202Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:58:33.202Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:58:33.203Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "4ceca348-c839-4294-9169-bb6f071e184f",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:58:33.202Z",
  "time": "10:58 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:58:33.377Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T13:59:47.351Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:7659ed8a-fcd2-4e33-88b8-0e8fc3889974",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T13:59:47.350Z",
    "time": "10:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:59:48.683Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T13:58:29.829Z",
    "updatedBy": "ai",
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:58:28.626Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:7659ed8a-fcd2-4e33-88b8-0e8fc3889974",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T13:59:47.350Z",
    "time": "10:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T13:59:48.684Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T13:58:29.829Z",
      "updatedBy": "ai",
      "reservationSlots": {
        "guestName": "Marcelo Martinez"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:58:28.626Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:7659ed8a-fcd2-4e33-88b8-0e8fc3889974",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-26T13:59:47.350Z",
      "time": "10:59 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T13:59:48.684Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-26T13:59:48.688Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:59:48.689Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T13:59:48.691Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:59:49.202Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T13:59:49.204Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T13:59:53.194Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesitaría que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "guests": null,
    "checkin_date": null,
    "checkout_date": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, así como cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-26T13:59:53.194Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:59:53.195Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T13:59:53.195Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T13:59:53.195Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "84c8fce8-9932-44da-ac2e-5e0051b89a99",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T13:59:53.195Z",
  "time": "10:59 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T13:59:53.368Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:16:23.031Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b1f9679e-343a-4b1f-9423-9beeffb6179e",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:16:23.029Z",
    "time": "11:16 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:16:25.008Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T13:59:49.023Z",
    "updatedBy": "ai",
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T13:59:47.843Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b1f9679e-343a-4b1f-9423-9beeffb6179e",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:16:23.029Z",
    "time": "11:16 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:16:25.010Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T13:59:49.023Z",
      "updatedBy": "ai",
      "reservationSlots": {
        "guestName": "Doble",
        "roomType": "doble"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T13:59:47.843Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b1f9679e-343a-4b1f-9423-9beeffb6179e",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-26T14:16:23.029Z",
      "time": "11:16 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:16:25.010Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Doble
- Habitación: doble
- Estado: qualify
[2025-09-26T14:16:25.361Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Doble\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:16:25.362Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T14:16:25.367Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Doble\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:16:25.929Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T14:16:25.933Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Doble\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:16:29.486Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesitaría que me proporciones las siguientes informaciones: fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación que deseas.",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T14:16:29.486Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Doble\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:16:29.487Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Doble\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:16:29.487Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:16:29.487Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "70161a22-1926-47f6-a803-656904a3a8a7",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:16:29.487Z",
  "time": "11:16 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:16:29.692Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:17:00.697Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e58acfbd-4b81-4bbe-a9ed-0678eb0ea4ab",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:17:00.697Z",
    "time": "11:17 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:17:02.239Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:16:23.713Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e58acfbd-4b81-4bbe-a9ed-0678eb0ea4ab",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:17:00.697Z",
    "time": "11:17 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:17:02.240Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:16:23.713Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e58acfbd-4b81-4bbe-a9ed-0678eb0ea4ab",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-26T14:17:00.697Z",
      "time": "11:17 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:17:02.240Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-26T14:17:02.245Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:17:02.248Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:17:02.761Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {},
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T14:17:02.763Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:17:07.169Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesitaría que me proporciones las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": null,
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar información adicional para completar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T14:17:07.169Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:17:07.169Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:17:07.170Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:17:07.170Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "4c489c95-b006-4871-9dc6-01be0f375434",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:17:07.170Z",
  "time": "11:17 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:17:07.340Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:19:22.523Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:491ff700-2784-4b86-b989-31e6ff8bd894",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:19:22.523Z",
    "time": "11:19 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:19:24.394Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T14:17:02.578Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:17:01.180Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:491ff700-2784-4b86-b989-31e6ff8bd894",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:19:22.523Z",
    "time": "11:19 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:19:24.394Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T14:17:02.578Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:17:01.180Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:491ff700-2784-4b86-b989-31e6ff8bd894",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-26T14:19:22.523Z",
      "time": "11:19 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:19:24.394Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-26T14:19:24.398Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:19:24.399Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T14:19:24.402Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:19:24.930Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T14:19:24.931Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:19:27.612Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-26T14:19:27.612Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:19:27.613Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:19:27.613Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:19:27.613Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "74504926-02b2-4aec-8dd0-45c9fdeb2410",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:19:27.613Z",
  "time": "11:19 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:19:27.787Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:20:32.379Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5cf89d2f-9dcb-4c06-b0c9-babe9e6598c5",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T14:20:32.378Z",
    "time": "11:20 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:20:33.827Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T14:19:24.759Z",
    "updatedBy": "ai",
    "reservationSlots": {
      "guestName": "Marcelo Martinez"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:19:23.254Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5cf89d2f-9dcb-4c06-b0c9-babe9e6598c5",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-26T14:20:32.378Z",
    "time": "11:20 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:20:33.827Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T14:19:24.759Z",
      "updatedBy": "ai",
      "reservationSlots": {
        "guestName": "Marcelo Martinez"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:19:23.254Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5cf89d2f-9dcb-4c06-b0c9-babe9e6598c5",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-26T14:20:32.378Z",
      "time": "11:20 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:20:33.827Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-26T14:20:33.831Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:20:33.832Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T14:20:33.834Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:20:34.332Z] [DEBUG] [Graph] Exit handleReservationNode (missing fields, nunca retrieval) {
  "result": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "category": "reservation",
    "salesStage": "qualify"
  }
}
[2025-09-26T14:20:34.335Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:20:39.004Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesitaría que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes que se alojarán. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, y cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-26T14:20:39.004Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:20:39.005Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Doble",
    "roomType": "doble"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Doble",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:20:39.005Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:20:39.006Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "7eab2e09-9d90-498e-8245-a1ab1e5f827a",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:20:39.005Z",
  "time": "11:20 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:20:39.176Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:34:06.138Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bcf35fe0-f1ec-4cb3-a75c-6f0b6e36e5b0",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:34:06.136Z",
    "time": "11:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:34:08.024Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:20:32.873Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bcf35fe0-f1ec-4cb3-a75c-6f0b6e36e5b0",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-26T14:34:06.136Z",
    "time": "11:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:34:08.026Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:20:32.873Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:bcf35fe0-f1ec-4cb3-a75c-6f0b6e36e5b0",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-26T14:34:06.136Z",
      "time": "11:34 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:34:08.026Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-26T14:34:08.347Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:08.354Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:10.268Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:34:14.277Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesito que me proporciones las siguientes informaciones: la fecha de check-in, la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas.",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-26T14:34:14.278Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:14.278Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:14.279Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:34:14.279Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "884b70fd-1735-436d-8076-106e9e3802bd",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:34:14.279Z",
  "time": "11:34 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:34:14.459Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:34:29.392Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:23e6fff0-bc99-4d29-aace-cecc715955fb",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:34:29.392Z",
    "time": "11:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:34:30.737Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T14:34:09.996Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:34:06.777Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:23e6fff0-bc99-4d29-aace-cecc715955fb",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:34:29.392Z",
    "time": "11:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:34:30.737Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T14:34:09.996Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:34:06.777Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:23e6fff0-bc99-4d29-aace-cecc715955fb",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-26T14:34:29.392Z",
      "time": "11:34 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:34:30.738Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-26T14:34:30.746Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:30.747Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T14:34:30.752Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:32.327Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:34:35.643Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor proporciona las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-26T14:34:35.644Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:35.644Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:34:35.644Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:34:35.645Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "5d0411da-2f01-4cc9-bfde-05629340e388",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:34:35.644Z",
  "time": "11:34 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:34:35.817Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-26T14:35:47.870Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6a475dcb-6b69-44b2-b920-ebd36604835d",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:35:47.869Z",
    "time": "11:35 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:35:49.253Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-26T14:34:32.153Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:34:29.886Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6a475dcb-6b69-44b2-b920-ebd36604835d",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-26T14:35:47.869Z",
    "time": "11:35 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-26T14:35:49.254Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-26T14:34:32.153Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:34:29.886Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6a475dcb-6b69-44b2-b920-ebd36604835d",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-26T14:35:47.869Z",
      "time": "11:35 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-26T14:35:49.254Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-26T14:35:49.259Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:35:49.260Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-26T14:35:49.262Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:35:51.321Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-26T14:35:55.834Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-26T14:35:55.835Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:35:55.835Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-26T14:35:55.835Z] [DEBUG] [handleIncomingMessage] suggestion Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?
[2025-09-26T14:35:55.836Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "56367a89-1e86-4f57-849d-ba5e110361ae",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?",
  "timestamp": "2025-09-26T14:35:55.835Z",
  "time": "11:35 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-26T14:35:56.322Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Para avanzar, ¿me pasás nombre completo, tipo de habitación, fecha de check-in (dd/mm/aaaa), fecha de check-out (dd/mm/aaaa), número de huéspedes?"
}
[2025-09-27T08:38:20.843Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:20.863Z] [WARN] [agentGraph] ⚠️ No graph module found. Using minimal fallback.
[2025-09-27T08:38:20.876Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:20.888Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:20.897Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:20.902Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:21.490Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-27T08:38:21.520Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-27T08:38:21.523Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:21.524Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-27T08:38:21.559Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:21.569Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:773:19
[2025-09-27T08:38:21.607Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-27T08:38:21.608Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-27T08:38:21.610Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T08:38:21.611Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-27T09:10:51.752Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f251b3f9-7cbe-47b0-b27d-025409837989",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:10:51.747Z",
    "time": "06:10 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:10:53.974Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-26T14:35:48.383Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f251b3f9-7cbe-47b0-b27d-025409837989",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:10:51.747Z",
    "time": "06:10 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:10:53.982Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-26T14:35:48.383Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f251b3f9-7cbe-47b0-b27d-025409837989",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "hola",
      "suggestion": "",
      "timestamp": "2025-09-27T09:10:51.747Z",
      "time": "06:10 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:10:53.982Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:10:54.733Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:10:56.967Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "hola",
  "category": "support",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "ambiguity_policy",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.9,
  "intentSource": "llm",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:10:59.812Z] [DEBUG] [bodyLLM] structured {
  "answer": "¡Hola! Bienvenido al Hotel Demo. ¿En qué puedo ayudarte hoy?",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T09:10:59.814Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:10:59.815Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:10:59.816Z] [DEBUG] [handleIncomingMessage] suggestion Estoy para ayudarte. ¿Podés contarme brevemente el problema?
[2025-09-27T09:10:59.817Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "fcfd400a-2188-4858-b2f5-3a4e10e4487c",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "timestamp": "2025-09-27T09:10:59.816Z",
  "time": "06:10 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:11:00.011Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?"
}
[2025-09-27T09:11:11.409Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:aa504281-3390-4679-8c7b-5c44602f5bb9",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:11.409Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:13.324Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:10:52.637Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:aa504281-3390-4679-8c7b-5c44602f5bb9",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:11.409Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:13.325Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:10:52.637Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:aa504281-3390-4679-8c7b-5c44602f5bb9",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-27T09:11:11.409Z",
      "time": "06:11 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:11:13.326Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:11:13.334Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:13.343Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:15.974Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "guestName"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "locale": "es"
  }
}
[2025-09-27T09:11:16.192Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:11:18.752Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarle con su reserva, necesitaría que me proporcione las siguientes informaciones: fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación que desea.  ",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:11:18.754Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:18.756Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:18.756Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es tu nombre?
[2025-09-27T09:11:18.756Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "c55505ab-598b-45e0-978a-52b8004ef16b",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es tu nombre?",
  "suggestion": "¿Cuál es tu nombre?",
  "timestamp": "2025-09-27T09:11:18.756Z",
  "time": "06:11 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:11:18.956Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es tu nombre?"
}
[2025-09-27T09:11:30.388Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:c4891e6b-c026-4d98-a814-37a3aeec5b21",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:30.388Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:32.306Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:11:15.978Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:11:12.094Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:c4891e6b-c026-4d98-a814-37a3aeec5b21",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:30.388Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:32.307Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:11:15.978Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:11:12.094Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:c4891e6b-c026-4d98-a814-37a3aeec5b21",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-27T09:11:30.388Z",
      "time": "06:11 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:11:32.307Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-27T09:11:32.315Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:32.318Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:11:32.323Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:34.523Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  }
}
[2025-09-27T09:11:34.770Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:11:37.179Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T09:11:37.180Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:37.181Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:37.181Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es el tipo de habitación que preferís?
[2025-09-27T09:11:37.182Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "e8dcb159-34ba-4287-966d-a6dfa0cd35a7",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es el tipo de habitación que preferís?",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?",
  "timestamp": "2025-09-27T09:11:37.181Z",
  "time": "06:11 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:11:37.385Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?"
}
[2025-09-27T09:11:45.988Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d01f7885-8477-4200-b266-cf0bfda1b482",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:45.987Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:47.832Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:11:34.525Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:11:31.140Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d01f7885-8477-4200-b266-cf0bfda1b482",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:11:45.987Z",
    "time": "06:11 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:11:47.833Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:11:34.525Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:11:31.140Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:d01f7885-8477-4200-b266-cf0bfda1b482",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-27T09:11:45.987Z",
      "time": "06:11 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:11:47.834Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:11:47.842Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:47.843Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:11:47.847Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:50.395Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "locale": "es"
  }
}
[2025-09-27T09:11:50.574Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:11:53.670Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesitaría que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes que se alojarán. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-in y check-out, y cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-27T09:11:53.672Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:53.673Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:11:53.674Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-in?
[2025-09-27T09:11:53.674Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "b92e01bd-0c9a-49dc-bac2-25dcfa56f0c3",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-in?",
  "suggestion": "¿Cuál es la fecha de check-in?",
  "timestamp": "2025-09-27T09:11:53.674Z",
  "time": "06:11 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:11:53.976Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-in?"
}
[2025-09-27T09:12:20.092Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4c752589-3971-44a8-a7d3-ccffc68ced34",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:12:20.091Z",
    "time": "06:12 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:12:21.799Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:11:50.396Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:11:46.705Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4c752589-3971-44a8-a7d3-ccffc68ced34",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:12:20.091Z",
    "time": "06:12 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:12:21.801Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:11:50.396Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:11:46.705Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4c752589-3971-44a8-a7d3-ccffc68ced34",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "02/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:12:20.091Z",
      "time": "06:12 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:12:21.801Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:12:21.810Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:21.812Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:12:21.819Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:23.377Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "locale": "es"
  }
}
[2025-09-27T09:12:23.673Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "02/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:12:29.725Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesito que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-02",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan datos de check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:12:29.727Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:29.728Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:29.729Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-out?
[2025-09-27T09:12:29.743Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "fa590054-b68a-4be4-a1b9-65eb0643db41",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-out?",
  "suggestion": "¿Cuál es la fecha de check-out?",
  "timestamp": "2025-09-27T09:12:29.743Z",
  "time": "06:12 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:12:30.531Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-out?"
}
[2025-09-27T09:12:46.300Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f3216ba2-239d-4387-b336-962c515a4d37",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:12:46.300Z",
    "time": "06:12 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:12:48.455Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:12:23.379Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:12:20.701Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f3216ba2-239d-4387-b336-962c515a4d37",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:12:46.300Z",
    "time": "06:12 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:12:48.456Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:12:23.379Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:12:20.701Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f3216ba2-239d-4387-b336-962c515a4d37",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "04/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:12:46.300Z",
      "time": "06:12 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:12:48.457Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:12:48.467Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:48.468Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:12:48.472Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:49.993Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "locale": "es"
  }
}
[2025-09-27T09:12:50.194Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "04/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:12:52.651Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesito que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-04",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar check-out, huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:12:52.652Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:52.653Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:12:52.653Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-out?
[2025-09-27T09:12:52.653Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "c5214f6e-3832-42c2-a6ea-d5287220f25e",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-out?",
  "suggestion": "¿Cuál es la fecha de check-out?",
  "timestamp": "2025-09-27T09:12:52.653Z",
  "time": "06:12 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:12:52.825Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-out?"
}
[2025-09-27T09:13:17.533Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b4ed6bd9-006f-4db6-941f-f5600ff3aed6",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:13:17.532Z",
    "time": "06:13 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:13:19.512Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:12:49.995Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:12:47.082Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b4ed6bd9-006f-4db6-941f-f5600ff3aed6",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:13:17.532Z",
    "time": "06:13 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:13:19.513Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:12:49.995Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:12:47.082Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b4ed6bd9-006f-4db6-941f-f5600ff3aed6",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "04/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:13:17.532Z",
      "time": "06:13 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:13:19.514Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:13:19.523Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:13:19.524Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:13:19.527Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:13:21.529Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "locale": "es"
  }
}
[2025-09-27T09:13:21.734Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "04/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:13:24.702Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesito que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-04",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-out, cantidad de huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:13:24.703Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:13:24.704Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:13:24.705Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-out?
[2025-09-27T09:13:24.705Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "6a427368-2ecb-4aac-95de-c7bb29c8fce9",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-out?",
  "suggestion": "¿Cuál es la fecha de check-out?",
  "timestamp": "2025-09-27T09:13:24.705Z",
  "time": "06:13 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:13:24.905Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-out?"
}
[2025-09-27T09:36:10.074Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:889ff917-4659-4049-9136-e81100e51ef1",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:10.068Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:12.444Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:13:18.283Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:889ff917-4659-4049-9136-e81100e51ef1",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:10.068Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:12.449Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:13:18.283Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:889ff917-4659-4049-9136-e81100e51ef1",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "hola",
      "suggestion": "",
      "timestamp": "2025-09-27T09:36:10.068Z",
      "time": "06:36 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:36:12.450Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:36:13.112Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:14.429Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "hola",
  "category": "support",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "ambiguity_policy",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.9,
  "intentSource": "llm",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:36:16.042Z] [DEBUG] [bodyLLM] structured {
  "answer": "¡Hola! Bienvenido al Hotel Demo. ¿En qué puedo ayudarte hoy?",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T09:36:16.043Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:16.044Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:16.045Z] [DEBUG] [handleIncomingMessage] suggestion Estoy para ayudarte. ¿Podés contarme brevemente el problema?
[2025-09-27T09:36:16.046Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "ac8d4f84-a947-4119-a2e5-31a30ceb4846",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "timestamp": "2025-09-27T09:36:16.046Z",
  "time": "06:36 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:36:16.232Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?"
}
[2025-09-27T09:36:27.550Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4a67d45e-181c-478e-916e-94db9b0c1e36",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:27.549Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:29.394Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:36:10.902Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4a67d45e-181c-478e-916e-94db9b0c1e36",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:27.549Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:29.395Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:36:10.902Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4a67d45e-181c-478e-916e-94db9b0c1e36",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-27T09:36:27.549Z",
      "time": "06:36 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:36:29.395Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:36:29.409Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:29.417Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:30.772Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "guestName"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "locale": "es"
  }
}
[2025-09-27T09:36:31.079Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:36:33.637Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesitaría que me proporciones las siguientes informaciones: \n1. Fecha de check-in.\n2. Fecha de check-out.\n3. Cantidad de huéspedes.\n4. Tipo de habitación que prefieres.",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas, cantidad de huéspedes y tipo de habitación para la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:36:33.644Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:33.647Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:33.647Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es tu nombre?
[2025-09-27T09:36:33.648Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "729a188a-da12-4dc8-8039-14a32e60995d",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es tu nombre?",
  "suggestion": "¿Cuál es tu nombre?",
  "timestamp": "2025-09-27T09:36:33.647Z",
  "time": "06:36 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:36:33.838Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es tu nombre?"
}
[2025-09-27T09:36:45.001Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f55311df-977d-4f2c-8603-06cd6ab6fae8",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:45.001Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:46.849Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:36:30.775Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:36:28.207Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f55311df-977d-4f2c-8603-06cd6ab6fae8",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:36:45.001Z",
    "time": "06:36 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:36:46.850Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:36:30.775Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:36:28.207Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:f55311df-977d-4f2c-8603-06cd6ab6fae8",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-27T09:36:45.001Z",
      "time": "06:36 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:36:46.851Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-27T09:36:46.866Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:46.869Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:36:46.882Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:48.510Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  }
}
[2025-09-27T09:36:48.791Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:36:50.947Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, gracias por contactar al Hotel Demo. ¿En qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T09:36:50.948Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:50.949Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:36:50.949Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es el tipo de habitación que preferís?
[2025-09-27T09:36:50.950Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "3a359408-21ec-42f4-aab0-dc11602f43c6",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es el tipo de habitación que preferís?",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?",
  "timestamp": "2025-09-27T09:36:50.949Z",
  "time": "06:36 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:36:51.143Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?"
}
[2025-09-27T09:37:00.235Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:045409be-11e0-4701-8df7-82257ca79799",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:00.235Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:02.102Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:36:48.513Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:36:45.616Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:045409be-11e0-4701-8df7-82257ca79799",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:00.235Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:02.104Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:36:48.513Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:36:45.616Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:045409be-11e0-4701-8df7-82257ca79799",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-27T09:37:00.235Z",
      "time": "06:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:37:02.104Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:37:02.115Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:02.116Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:37:02.119Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:03.742Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "locale": "es"
  }
}
[2025-09-27T09:37:03.945Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:37:09.507Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesitaría que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes que se alojarán. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "checkin_date": null,
    "checkout_date": null,
    "guests": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, y cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-27T09:37:09.509Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:09.510Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:09.510Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-in?
[2025-09-27T09:37:09.511Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "54af9b37-d066-4755-a7e6-0a9d18f42312",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-in?",
  "suggestion": "¿Cuál es la fecha de check-in?",
  "timestamp": "2025-09-27T09:37:09.511Z",
  "time": "06:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:37:10.194Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-in?"
}
[2025-09-27T09:37:22.690Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:72715fa1-c65c-4ccc-8852-02956607933c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:22.689Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:24.733Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:37:03.743Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:37:00.872Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:72715fa1-c65c-4ccc-8852-02956607933c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:22.689Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:24.734Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:37:03.743Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:37:00.872Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:72715fa1-c65c-4ccc-8852-02956607933c",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "02/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:37:22.689Z",
      "time": "06:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:37:24.735Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:37:24.750Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:24.751Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:37:24.756Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:27.912Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "locale": "es"
  }
}
[2025-09-27T09:37:28.112Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "02/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:37:30.980Z] [DEBUG] [bodyLLM] structured {
  "answer": "Gracias por tu consulta. Para poder ayudarte con la reserva, necesitaría que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-02",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan datos de check-out, huéspedes y tipo de habitación para completar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:37:30.981Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:30.982Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:30.983Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-out?
[2025-09-27T09:37:30.983Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "7106efc3-dc47-4dc6-b35a-53efea3fe716",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-out?",
  "suggestion": "¿Cuál es la fecha de check-out?",
  "timestamp": "2025-09-27T09:37:30.983Z",
  "time": "06:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:37:31.182Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-out?"
}
[2025-09-27T09:37:44.186Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:481fbe93-8a25-417a-bda3-430849af896c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:44.186Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:45.828Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:37:27.915Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:37:23.399Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:481fbe93-8a25-417a-bda3-430849af896c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:44.186Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:45.830Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:37:27.915Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:37:23.399Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:481fbe93-8a25-417a-bda3-430849af896c",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "04/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:37:44.186Z",
      "time": "06:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:37:45.831Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:37:45.843Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:45.844Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:37:45.847Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:47.887Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "04/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:37:51.155Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola, gracias por tu consulta. Para poder ayudarte con la reserva, necesitaría que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. Quedo atento a tu respuesta.",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-04",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan datos para completar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:37:51.156Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:51.157Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:51.158Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuántos huéspedes se alojarán?
[2025-09-27T09:37:51.159Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "1aeec0b8-3185-455f-98d0-37ec873f84c6",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuántos huéspedes se alojarán?",
  "suggestion": "¿Cuántos huéspedes se alojarán?",
  "timestamp": "2025-09-27T09:37:51.158Z",
  "time": "06:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:37:51.337Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuántos huéspedes se alojarán?"
}
[2025-09-27T09:37:56.067Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:15299631-3f2d-4338-bc30-61216b1a4a2c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "2",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:56.066Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:57.706Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:37:47.593Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:37:44.801Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:15299631-3f2d-4338-bc30-61216b1a4a2c",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "2",
    "suggestion": "",
    "timestamp": "2025-09-27T09:37:56.066Z",
    "time": "06:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:37:57.707Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02",
        "checkOut": "2025-10-04"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:37:47.593Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:37:44.801Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:15299631-3f2d-4338-bc30-61216b1a4a2c",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "2",
      "suggestion": "",
      "timestamp": "2025-09-27T09:37:56.066Z",
      "time": "06:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:37:57.708Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Fechas: 2025-10-02 → 2025-10-04
- Estado: qualify
[2025-09-27T09:37:57.725Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:57.726Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:37:57.730Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:37:59.756Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "2",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:38:02.428Z] [DEBUG] [bodyLLM] structured {
  "answer": "Por favor, indícame las fechas de check-in y check-out, así como el tipo de habitación que prefieres para poder ayudarte con la reserva.",
  "intent": "reservation_inquiry",
  "entities": {
    "guests": 2,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-in y check-out, y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:38:02.429Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:38:02.430Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:38:02.431Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuántos huéspedes se alojarán?
[2025-09-27T09:38:02.431Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "1be133df-55d8-4802-ac8c-48326bf206df",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuántos huéspedes se alojarán?",
  "suggestion": "¿Cuántos huéspedes se alojarán?",
  "timestamp": "2025-09-27T09:38:02.431Z",
  "time": "06:37 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:38:02.723Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuántos huéspedes se alojarán?"
}
[2025-09-27T09:46:31.419Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:10af2069-57cf-4d02-be05-0b4903bb1dde",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:46:31.414Z",
    "time": "06:46 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:46:33.488Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:37:56.681Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:10af2069-57cf-4d02-be05-0b4903bb1dde",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-27T09:46:31.414Z",
    "time": "06:46 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:46:33.491Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:37:56.681Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:10af2069-57cf-4d02-be05-0b4903bb1dde",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "hola",
      "suggestion": "",
      "timestamp": "2025-09-27T09:46:31.414Z",
      "time": "06:46 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:46:33.492Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:46:34.174Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:35.357Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "hola",
  "category": "support",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "ambiguity_policy",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {},
  "intentConfidence": 0.9,
  "intentSource": "llm",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:46:37.176Z] [DEBUG] [bodyLLM] structured {
  "answer": "¡Hola! Bienvenido al Hotel Demo. ¿En qué puedo ayudarte hoy?",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T09:46:37.177Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:37.178Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "nextCategory": "support",
  "nextSlots": {},
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "support",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "ambiguity_policy",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.9,
    "intentSource": "llm",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:37.179Z] [DEBUG] [handleIncomingMessage] suggestion Estoy para ayudarte. ¿Podés contarme brevemente el problema?
[2025-09-27T09:46:37.180Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "d233b874-9f69-4aa4-8119-d2e4bb4e590c",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
  "timestamp": "2025-09-27T09:46:37.179Z",
  "time": "06:46 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:46:37.480Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?"
}
[2025-09-27T09:46:47.008Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:93134e09-bb47-4c4f-ab17-c64d4ba9896a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:46:47.007Z",
    "time": "06:46 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:46:48.744Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": null,
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:46:32.051Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:93134e09-bb47-4c4f-ab17-c64d4ba9896a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "quiero reservar",
    "suggestion": "",
    "timestamp": "2025-09-27T09:46:47.007Z",
    "time": "06:46 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:46:48.745Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": null,
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:46:32.051Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:93134e09-bb47-4c4f-ab17-c64d4ba9896a",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "quiero reservar",
      "suggestion": "",
      "timestamp": "2025-09-27T09:46:47.007Z",
      "time": "06:46 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:46:48.745Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
[2025-09-27T09:46:48.759Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:48.766Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:52.038Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "guestName"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "locale": "es"
  }
}
[2025-09-27T09:46:52.332Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "quiero reservar",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "locale": "es"
  },
  "intentConfidence": 0.75,
  "intentSource": "heuristic",
  "desiredAction": "create",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:46:55.743Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva, necesitaría que me proporciones las siguientes informaciones: \n1. Fecha de check-in \n2. Fecha de check-out \n3. Cantidad de huéspedes \n4. Tipo de habitación que prefieres \nUna vez que tenga esos datos, podré asistirte mejor.",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar información adicional para completar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:46:55.744Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:55.744Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es tu nombre?",
  "nextCategory": "reservation",
  "nextSlots": {
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "quiero reservar",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "locale": "es"
    },
    "intentConfidence": 0.75,
    "intentSource": "heuristic",
    "desiredAction": "create",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:46:55.745Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es tu nombre?
[2025-09-27T09:46:55.745Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "dd5a2b70-eacc-4d6e-b2ec-c06273f04f91",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es tu nombre?",
  "suggestion": "¿Cuál es tu nombre?",
  "timestamp": "2025-09-27T09:46:55.745Z",
  "time": "06:46 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:46:56.013Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es tu nombre?"
}
[2025-09-27T09:47:10.450Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b8b9c608-2ba0-4848-984c-f58ddf22e1f8",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:10.450Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:11.885Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {},
  "prevCategory": null,
  "prevSlotsStrict": {},
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:46:52.041Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:46:47.597Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b8b9c608-2ba0-4848-984c-f58ddf22e1f8",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "Marcelo Martinez",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:10.450Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:11.886Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {},
    "prevCategory": null,
    "prevSlotsStrict": {},
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:46:52.041Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:46:47.597Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:b8b9c608-2ba0-4848-984c-f58ddf22e1f8",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "Marcelo Martinez",
      "suggestion": "",
      "timestamp": "2025-09-27T09:47:10.450Z",
      "time": "06:47 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:47:11.886Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Estado: qualify
[2025-09-27T09:47:11.895Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:11.897Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:47:11.902Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {},
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:13.199Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "roomType"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  }
}
[2025-09-27T09:47:13.421Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "Marcelo Martinez",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:47:15.699Z] [DEBUG] [bodyLLM] structured {
  "answer": "Hola Marcelo, ¿en qué puedo ayudarte hoy? Si necesitas información sobre reservas, por favor indícame las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que prefieres.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:47:15.700Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:15.700Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es el tipo de habitación que preferís?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "Marcelo Martinez",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:15.701Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es el tipo de habitación que preferís?
[2025-09-27T09:47:15.701Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "2ff78e26-650c-485a-9149-095c8d038e22",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es el tipo de habitación que preferís?",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?",
  "timestamp": "2025-09-27T09:47:15.701Z",
  "time": "06:47 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:47:15.979Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es el tipo de habitación que preferís?"
}
[2025-09-27T09:47:23.455Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fc48db98-793f-4681-91ef-37c2129fdcb0",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:23.455Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:25.299Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:47:13.203Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:47:10.935Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fc48db98-793f-4681-91ef-37c2129fdcb0",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "doble",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:23.455Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:25.300Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:47:13.203Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:47:10.935Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fc48db98-793f-4681-91ef-37c2129fdcb0",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "doble",
      "suggestion": "",
      "timestamp": "2025-09-27T09:47:23.455Z",
      "time": "06:47 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:47:25.300Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:47:25.309Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:25.312Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:47:25.316Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:27.451Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkIn"
    ],
    "message": "Invalid input: expected string, received undefined"
  },
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "locale": "es"
  }
}
[2025-09-27T09:47:27.656Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "doble",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:47:31.134Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con la reserva de una habitación doble, necesito que me proporciones las fechas de check-in y check-out, así como la cantidad de huéspedes que se alojarán. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "room_type": "doble",
    "guests": null,
    "checkin_date": null,
    "checkout_date": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar fechas de check-in y check-out, y cantidad de huéspedes."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests"
  ],
  "language": "es"
}
[2025-09-27T09:47:31.135Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:31.136Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-in?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "doble",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:31.137Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-in?
[2025-09-27T09:47:31.137Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "f14c5959-6cc0-4679-8b00-d36eb7a11011",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-in?",
  "suggestion": "¿Cuál es la fecha de check-in?",
  "timestamp": "2025-09-27T09:47:31.137Z",
  "time": "06:47 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:47:31.338Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-in?"
}
[2025-09-27T09:47:41.272Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8a710f9b-1ad1-4807-91f3-a77c94501022",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:41.272Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:43.116Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:47:27.453Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:47:24.071Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8a710f9b-1ad1-4807-91f3-a77c94501022",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "02/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:47:41.272Z",
    "time": "06:47 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:47:43.117Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:47:27.453Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:47:24.071Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:8a710f9b-1ad1-4807-91f3-a77c94501022",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "02/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:47:41.272Z",
      "time": "06:47 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:47:43.117Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:47:43.123Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:43.125Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:47:43.133Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:46.093Z] [WARN] [BP-SLOTS7] Zod validation ERROR [
  {
    "expected": "string",
    "code": "invalid_type",
    "path": [
      "checkOut"
    ],
    "message": "Invalid input: expected string, received undefined"
  }
] {
  "full": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "locale": "es"
  }
}
[2025-09-27T09:47:46.290Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "quiero reservar",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "02/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:47:49.163Z] [DEBUG] [bodyLLM] structured {
  "answer": "Gracias por tu consulta. Para poder ayudarte con la reserva, necesito que me proporciones la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-02",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan datos de check-out, huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:47:49.163Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:49.164Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuál es la fecha de check-out?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Estoy para ayudarte. ¿Podés contarme brevemente el problema?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "quiero reservar",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "02/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:47:49.165Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuál es la fecha de check-out?
[2025-09-27T09:47:49.166Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "7656ff71-88f6-4325-a7c5-12b845df5d5e",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuál es la fecha de check-out?",
  "suggestion": "¿Cuál es la fecha de check-out?",
  "timestamp": "2025-09-27T09:47:49.166Z",
  "time": "06:47 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:47:49.361Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuál es la fecha de check-out?"
}
[2025-09-27T09:48:03.082Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:2a7baff7-9921-44ca-836d-5fca1402c1c5",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:03.082Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:05.031Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:47:46.095Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:47:41.888Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:2a7baff7-9921-44ca-836d-5fca1402c1c5",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "04/10/2025",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:03.082Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:05.032Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:47:46.095Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:47:41.888Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:2a7baff7-9921-44ca-836d-5fca1402c1c5",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "04/10/2025",
      "suggestion": "",
      "timestamp": "2025-09-27T09:48:03.082Z",
      "time": "06:48 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:48:05.032Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Estado: qualify
[2025-09-27T09:48:05.038Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:05.043Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:48:05.046Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:06.976Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es tu nombre?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "Marcelo Martinez",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "04/10/2025",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "qualify",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:48:11.175Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarle con su reserva, necesitaría que me proporcione la fecha de check-out, la cantidad de huéspedes y el tipo de habitación que desea. ¿Podría facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {
    "checkin_date": "2025-10-04",
    "checkout_date": null,
    "guests": null,
    "room_type": null,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan datos de check-out, huéspedes y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:48:11.176Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:11.177Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¿Cuántos huéspedes se alojarán?",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es tu nombre?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "Marcelo Martinez",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "04/10/2025",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:11.178Z] [DEBUG] [handleIncomingMessage] suggestion ¿Cuántos huéspedes se alojarán?
[2025-09-27T09:48:11.178Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "b92aae89-7e9c-493e-80d9-880409894845",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¿Cuántos huéspedes se alojarán?",
  "suggestion": "¿Cuántos huéspedes se alojarán?",
  "timestamp": "2025-09-27T09:48:11.178Z",
  "time": "06:48 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:48:11.376Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¿Cuántos huéspedes se alojarán?"
}
[2025-09-27T09:48:19.581Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5dc59664-a555-426c-9cb5-d8c96c3a0ba9",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "2",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:19.580Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:21.413Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "doble",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "salesStage": "qualify",
    "updatedAt": "2025-09-27T09:48:06.743Z",
    "updatedBy": "ai"
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:48:03.826Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5dc59664-a555-426c-9cb5-d8c96c3a0ba9",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "2",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:19.580Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:21.414Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "doble",
        "checkIn": "2025-10-02",
        "checkOut": "2025-10-04"
      },
      "salesStage": "qualify",
      "updatedAt": "2025-09-27T09:48:06.743Z",
      "updatedBy": "ai"
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:48:03.826Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:5dc59664-a555-426c-9cb5-d8c96c3a0ba9",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "2",
      "suggestion": "",
      "timestamp": "2025-09-27T09:48:19.580Z",
      "time": "06:48 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:48:21.415Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: doble
- Fechas: 2025-10-02 → 2025-10-04
- Estado: qualify
[2025-09-27T09:48:21.430Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:21.431Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:48:21.434Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "doble",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "qualify",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:24.895Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es el tipo de habitación que preferís?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "doble",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "2",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:48:27.661Z] [DEBUG] [bodyLLM] structured {
  "answer": "Por favor, indícame las fechas de check-in y check-out, así como el tipo de habitación que prefieres para poder ayudarte con la reserva.",
  "intent": "reservation_inquiry",
  "entities": {
    "guests": 2,
    "channel": "web"
  },
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Faltan fechas de check-in y check-out, y tipo de habitación."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:48:27.662Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:27.663Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: doble\n- Fechas: 2025-10-02 → 2025-10-04\n- Estado: qualify",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es el tipo de habitación que preferís?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "doble",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "2",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:27.663Z] [DEBUG] [handleIncomingMessage] suggestion Tengo double disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T09:48:27.664Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "7b156c73-5295-43a5-a153-1e86d09f5b62",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T09:48:27.663Z",
  "time": "06:48 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:48:27.863Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”."
}
[2025-09-27T09:48:41.792Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:0e0b1c5b-3d47-4a96-b674-f50af4ccc8aa",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "CONFIRMAR",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:41.791Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:44.454Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T09:48:24.667Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo double disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02",
          "checkOut": "2025-10-04"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T09:48:24.667Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:48:20.183Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:0e0b1c5b-3d47-4a96-b674-f50af4ccc8aa",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "CONFIRMAR",
    "suggestion": "",
    "timestamp": "2025-09-27T09:48:41.791Z",
    "time": "06:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T09:48:44.455Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02",
        "checkOut": "2025-10-04",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T09:48:24.667Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo double disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02",
            "checkOut": "2025-10-04"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T09:48:24.667Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:48:20.183Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:0e0b1c5b-3d47-4a96-b674-f50af4ccc8aa",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "CONFIRMAR",
      "suggestion": "",
      "timestamp": "2025-09-27T09:48:41.791Z",
      "time": "06:48 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T09:48:44.455Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02 → 2025-10-04
- Huéspedes: 2
- Estado: quote
[2025-09-27T09:48:44.461Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02 → 2025-10-04\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:44.461Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T09:48:44.469Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02 → 2025-10-04\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:47.730Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02 → 2025-10-04\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-in?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "02/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "CONFIRMAR",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T09:48:49.862Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte a confirmar una reserva, necesitaría que me proporciones las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación que deseas. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar información adicional para confirmar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T09:48:49.863Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02 → 2025-10-04\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:49.864Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02",
    "checkOut": "2025-10-04",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02 → 2025-10-04\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-in?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "02/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02",
      "checkOut": "2025-10-04",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T09:48:49.864Z] [DEBUG] [handleIncomingMessage] suggestion ✅ ¡Reserva confirmada! Código **mock-211075**.
Habitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!
[2025-09-27T09:48:49.864Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "b8cda55c-139d-4593-ba3c-0485450579aa",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "suggestion": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "timestamp": "2025-09-27T09:48:49.864Z",
  "time": "06:48 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T09:48:50.082Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!"
}
[2025-09-27T13:29:35.716Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4766155b-4ad6-4953-ad5d-f9bf4db66102",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva, confirma por favor",
    "suggestion": "",
    "timestamp": "2025-09-27T13:29:35.713Z",
    "time": "10:29 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:29:37.797Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T09:48:46.503Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo double disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02",
          "checkOut": "2025-10-04"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T09:48:24.667Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T09:48:43.433Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4766155b-4ad6-4953-ad5d-f9bf4db66102",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva, confirma por favor",
    "suggestion": "",
    "timestamp": "2025-09-27T13:29:35.713Z",
    "time": "10:29 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:29:37.799Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T09:48:46.503Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo double disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02",
            "checkOut": "2025-10-04"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T09:48:24.667Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T09:48:43.433Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4766155b-4ad6-4953-ad5d-f9bf4db66102",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva, confirma por favor",
      "suggestion": "",
      "timestamp": "2025-09-27T13:29:35.713Z",
      "time": "10:29 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T13:29:37.800Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T13:29:38.192Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, confirma por favor",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:29:38.193Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T13:29:38.204Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, confirma por favor",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:29:41.588Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuál es la fecha de check-out?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "04/10/2025",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva, confirma por favor",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T13:29:45.234Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lo siento, pero no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para confirmar tu reserva.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T13:29:45.234Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, confirma por favor",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:29:45.235Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuál es la fecha de check-out?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "04/10/2025",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, confirma por favor",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:29:45.235Z] [DEBUG] [handleIncomingMessage] suggestion Tengo doble disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T13:29:45.236Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "470e2117-b044-4c9a-b0d9-0d75f88242d8",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T13:29:45.235Z",
  "time": "10:29 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-27T13:29:45.431Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-27T13:34:38.386Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:edde3826-0599-47d8-b642-c4fd133f2fcb",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes averiguar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:34:38.384Z",
    "time": "10:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:34:40.046Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T13:29:41.382Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T13:29:41.382Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T13:29:36.395Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:edde3826-0599-47d8-b642-c4fd133f2fcb",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes averiguar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:34:38.384Z",
    "time": "10:34 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:34:40.048Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T13:29:41.382Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T13:29:41.382Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T13:29:36.395Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:edde3826-0599-47d8-b642-c4fd133f2fcb",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva confirmada, puedes averiguar?",
      "suggestion": "",
      "timestamp": "2025-09-27T13:34:38.384Z",
      "time": "10:34 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T13:34:40.049Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T13:34:40.366Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes averiguar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:34:40.367Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T13:34:40.375Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes averiguar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:34:43.841Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¿Cuántos huéspedes se alojarán?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "2",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva confirmada, puedes averiguar?",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T13:34:45.620Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:34:46.241Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lo siento, pero no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para verificar el estado de tu reserva.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T13:34:46.242Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes averiguar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:34:46.242Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¿Cuántos huéspedes se alojarán?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "2",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes averiguar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:34:46.243Z] [DEBUG] [handleIncomingMessage] suggestion Tengo doble disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T13:34:46.243Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "ac1d8950-34f2-422a-a3bc-f3b7214d0356",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T13:34:46.243Z",
  "time": "10:34 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-27T13:34:46.440Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-27T13:34:56.572Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:35:07.578Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:35:07.580Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:07.608Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:07.616Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:07.625Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:07.633Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:07.640Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:35:18.632Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:35:29.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:35:40.890Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:35:52.096Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:36:03.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:37:29.864Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:9a1f31c2-d9d1-4d10-8900-583351b6e31a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:37:29.862Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:37:31.333Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T13:34:43.664Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T13:34:43.664Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T13:34:38.998Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:9a1f31c2-d9d1-4d10-8900-583351b6e31a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:37:29.862Z",
    "time": "10:37 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:37:31.335Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T13:34:43.664Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T13:34:43.664Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T13:34:38.998Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:9a1f31c2-d9d1-4d10-8900-583351b6e31a",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva confirmada, puedes corroborar?",
      "suggestion": "",
      "timestamp": "2025-09-27T13:37:29.862Z",
      "time": "10:37 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T13:37:31.335Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T13:37:31.662Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:37:31.663Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T13:37:31.669Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:37:35.121Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T13:37:36.311Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:37:37.432Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lamentablemente, no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para verificar tu reserva. Ellos podrán ayudarte con cualquier consulta relacionada.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T13:37:37.433Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:37:37.433Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo double disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:37:37.433Z] [DEBUG] [handleIncomingMessage] suggestion Tengo doble disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T13:37:37.434Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "57e33614-04c2-473a-8b31-79065894c94f",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T13:37:37.434Z",
  "time": "10:37 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-27T13:37:37.630Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-27T13:37:46.615Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:37:56.970Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:38:07.383Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:38:17.846Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T13:38:28.353Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:38:38.904Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:38:49.505Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:00.165Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:10.871Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:21.624Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:32.435Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:43.293Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:39:54.196Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:40:05.152Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T13:40:16.163Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:40:16.165Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.200Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.218Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.229Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.239Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.251Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.266Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:40:16.273Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:54:49.441Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:75fcfc41-48e6-4cfe-8ac0-730338b4f16a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:54:49.439Z",
    "time": "10:54 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:54:50.829Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T13:37:34.938Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T13:37:34.938Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T13:37:30.367Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:75fcfc41-48e6-4cfe-8ac0-730338b4f16a",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T13:54:49.439Z",
    "time": "10:54 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T13:54:50.831Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T13:37:34.938Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T13:37:34.938Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T13:37:30.367Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:75fcfc41-48e6-4cfe-8ac0-730338b4f16a",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva confirmada, puedes corroborar?",
      "suggestion": "",
      "timestamp": "2025-09-27T13:54:49.439Z",
      "time": "10:54 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T13:54:50.831Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T13:54:51.157Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:54:51.331Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T13:54:51.337Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:54:51.720Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:54:54.694Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, confirma por favor",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T13:54:56.997Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lamentablemente, no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para confirmar tu reserva. Ellos podrán ayudarte con cualquier consulta relacionada.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T13:54:56.998Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:54:56.998Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-211075**.\nHabitación **double**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, confirma por favor",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T13:54:56.999Z] [DEBUG] [handleIncomingMessage] suggestion Tengo doble disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T13:54:56.999Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "5ec232fd-b474-4a92-b483-902bb704b8bb",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T13:54:56.999Z",
  "time": "10:54 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-27T13:54:57.250Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-27T13:55:02.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:55:12.375Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:55:22.777Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:55:33.234Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:55:43.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:55:54.295Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:04.904Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:15.559Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:26.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:37.032Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:47.839Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:56:58.692Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:57:09.604Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:57:20.559Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:57:31.565Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:57:31.567Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.601Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.620Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.633Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.647Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.656Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.665Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:31.675Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T13:57:42.617Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:57:53.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:58:04.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:58:16.083Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:58:27.344Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T13:58:38.657Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:58:50.012Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:01.419Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:12.873Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:24.383Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:35.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:47.554Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T13:59:59.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:00:10.919Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:00:22.673Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:00:34.484Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:00:46.342Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:00:58.245Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:01:10.209Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:01:22.214Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:01:34.224Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:01:34.225Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:01:34.246Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:01:34.259Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:01:34.270Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:01:46.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:01:58.235Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:02:10.247Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:02:22.253Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:02:34.263Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:02:46.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:02:58.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:03:10.286Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:03:22.294Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:03:34.305Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:03:46.312Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:03:58.316Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:04:10.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:04:22.338Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:04:34.349Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:04:46.355Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:04:58.363Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:05:10.377Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:05:22.383Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:05:34.389Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:05:46.395Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:05:46.396Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:05:46.411Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:05:46.427Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:05:46.439Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:05:58.399Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:06:10.413Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:06:22.421Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:06:34.431Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:06:46.439Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:06:58.444Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:07:10.458Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:07:22.465Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:09:45.174Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:09:57.181Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:10:09.184Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:10:21.197Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:10:33.204Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:10:45.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:10:57.214Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:11:09.224Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:11:21.237Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:11:33.245Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:11:45.255Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:11:57.261Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:12:09.273Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:12:21.287Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:12:33.297Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:12:45.304Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:12:57.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:13:09.319Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:13:21.329Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:13:33.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:13:45.346Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:16:25.159Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:3f7ecdfd-3488-4974-b661-47c15dd9715e",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:16:25.157Z",
    "time": "11:16 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:16:26.977Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T13:54:54.481Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T13:54:54.481Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T13:54:49.906Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:3f7ecdfd-3488-4974-b661-47c15dd9715e",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:16:25.157Z",
    "time": "11:16 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:16:26.979Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T13:54:54.481Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T13:54:54.481Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T13:54:49.906Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:3f7ecdfd-3488-4974-b661-47c15dd9715e",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva confirmada, puedes corroborar?",
      "suggestion": "",
      "timestamp": "2025-09-27T14:16:25.157Z",
      "time": "11:16 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T14:16:26.979Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T14:16:27.316Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:16:27.510Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T14:16:27.516Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:16:30.722Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes averiguar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T14:16:32.725Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lamentablemente, no puedo acceder a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para verificar el estado de tu reserva.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T14:16:32.726Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:16:32.727Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes averiguar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:16:32.727Z] [DEBUG] [handleIncomingMessage] suggestion Tengo doble disponible. Tarifa por noche: 100 USD.

¿Confirmás la reserva? Respondé “CONFIRMAR”.
[2025-09-27T14:16:32.728Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "5d25f250-e944-4058-9919-9cee2f3672d8",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "suggestion": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T14:16:32.728Z",
  "time": "11:16 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-27T14:16:32.921Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-27T14:17:14.152Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:17:24.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:17:34.319Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:17:44.473Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:17:54.684Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:04.943Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:15.248Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:25.609Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:36.019Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:46.474Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:18:56.987Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:19:07.546Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:19:18.153Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:19:28.806Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:19:39.518Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:19:50.278Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:01.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:11.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:22.858Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:33.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:44.820Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:20:44.822Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:20:44.861Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:20:44.877Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:20:44.889Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:20:55.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:24:10.534Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:10.566Z] [WARN] [agentGraph] ⚠️ No graph module found. Using minimal fallback.
[2025-09-27T14:24:10.578Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:10.593Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:10.609Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:10.612Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:11.011Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-27T14:24:11.032Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-27T14:24:11.034Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:11.035Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-27T14:24:11.061Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:11.065Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:775:19
[2025-09-27T14:24:11.084Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-27T14:24:11.085Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-27T14:24:11.087Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-27T14:24:11.087Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-27T14:29:27.224Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:ba6fccc0-9212-4a0e-b5b6-dafa03bb5fad",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:29:27.221Z",
    "time": "11:29 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:29:28.883Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T14:16:30.535Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T14:16:25.774Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:ba6fccc0-9212-4a0e-b5b6-dafa03bb5fad",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva confirmada, puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:29:27.221Z",
    "time": "11:29 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:29:28.885Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T14:16:30.535Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T14:16:25.774Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:ba6fccc0-9212-4a0e-b5b6-dafa03bb5fad",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva confirmada, puedes corroborar?",
      "suggestion": "",
      "timestamp": "2025-09-27T14:29:27.221Z",
      "time": "11:29 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T14:29:28.886Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T14:29:29.222Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:29:29.423Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
  "category": "reservation_verify",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_verify",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T14:29:31.488Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lo siento, pero no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para verificar el estado de tu reserva.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T14:29:31.488Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
  "nextCategory": "reservation_verify",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation_verify",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_verify",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:29:31.489Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
  "nextCategory": "reservation_verify",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva confirmada, puedes corroborar?",
    "category": "reservation_verify",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_verify",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:29:31.489Z] [DEBUG] [handleIncomingMessage] suggestion Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.
[2025-09-27T14:29:31.490Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "c747cfe2-57c7-4b03-960a-32a52298604d",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
  "suggestion": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
  "timestamp": "2025-09-27T14:29:31.489Z",
  "time": "11:29 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T14:29:31.665Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla."
}
[2025-09-27T14:29:35.362Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:29:45.515Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:29:55.718Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:30:05.976Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:30:16.279Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:30:26.631Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:30:37.044Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:30:47.498Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:30:58.002Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:31:08.564Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:31:19.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:31:29.827Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:31:40.529Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:31:51.287Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:02.096Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:12.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:23.861Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:34.822Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:45.829Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:32:45.832Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.867Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.879Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.889Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.900Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.910Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.920Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.928Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.938Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.948Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.954Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:45.970Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:32:56.882Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:33:07.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:33:19.141Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:33:30.347Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:33:41.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:33:52.911Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:34:04.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:34:15.681Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:34:27.137Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:34:38.649Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:34:50.206Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:48:20.825Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6cfe2726-99ee-40df-bcd4-a58f26574683",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:48:20.823Z",
    "time": "11:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:48:22.579Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T14:16:30.535Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T14:29:27.825Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6cfe2726-99ee-40df-bcd4-a58f26574683",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
    "suggestion": "",
    "timestamp": "2025-09-27T14:48:20.823Z",
    "time": "11:48 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:48:22.581Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T14:16:30.535Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T14:29:27.825Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:6cfe2726-99ee-40df-bcd4-a58f26574683",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
      "suggestion": "",
      "timestamp": "2025-09-27T14:48:20.823Z",
      "time": "11:48 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T14:48:22.581Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T14:48:22.905Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva en proceso,  puedes corroborar?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:48:23.330Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva en proceso,  puedes corroborar?",
  "category": "reservation_snapshot",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_snapshot",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.98,
  "intentSource": "heuristic",
  "salesStage": "quote",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T14:48:24.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:48:26.495Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lo siento, pero no tengo acceso a la información de reservas. Te recomiendo que contactes directamente a la recepción del Hotel Demo para que puedan ayudarte con tu consulta.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-27T14:48:26.496Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
  "nextCategory": "reservation_snapshot",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva en proceso,  puedes corroborar?",
    "category": "reservation_snapshot",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_snapshot",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.98,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:48:26.497Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
  "nextCategory": "reservation_snapshot",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva en proceso,  puedes corroborar?",
    "category": "reservation_snapshot",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_snapshot",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.98,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:48:26.497Z] [DEBUG] [handleIncomingMessage] suggestion Tu solicitud de reserva está en curso (aún no confirmada).

- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2

Para confirmar, respondé “CONFIRMAR”.
[2025-09-27T14:48:26.497Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "757b9643-d27f-45e0-b8d0-86c626ff8552",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
  "suggestion": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
  "timestamp": "2025-09-27T14:48:26.497Z",
  "time": "11:48 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T14:48:26.690Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”."
}
[2025-09-27T14:48:34.758Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:48:44.961Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:48:55.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:05.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:15.867Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:26.274Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:36.733Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:47.239Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:53.955Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:1b31e997-d6fd-4a01-81c2-7adc2f0524db",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "CONFIRMAR",
    "suggestion": "",
    "timestamp": "2025-09-27T14:49:53.954Z",
    "time": "11:49 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:49:55.287Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "quote",
    "updatedAt": "2025-09-27T14:16:30.535Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T14:48:21.421Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:1b31e997-d6fd-4a01-81c2-7adc2f0524db",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "CONFIRMAR",
    "suggestion": "",
    "timestamp": "2025-09-27T14:49:53.954Z",
    "time": "11:49 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-27T14:49:55.288Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "quote",
      "updatedAt": "2025-09-27T14:16:30.535Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T14:48:21.421Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:1b31e997-d6fd-4a01-81c2-7adc2f0524db",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "CONFIRMAR",
      "suggestion": "",
      "timestamp": "2025-09-27T14:49:53.954Z",
      "time": "11:49 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-27T14:49:55.288Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: quote
[2025-09-27T14:49:55.296Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:49:55.296Z] [DEBUG] [Graph] Exit classifyNode (reservation/hasAnySlot refuerzo) {
  "result": {
    "category": "reservation",
    "desiredAction": "modify",
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "promptKey": "reservation_flow",
    "messages": []
  }
}
[2025-09-27T14:49:55.303Z] [DEBUG] [Graph] Enter handleReservationNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "quote",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:49:57.791Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:49:58.229Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "CONFIRMAR",
  "category": "reservation",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_flow",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "desiredAction": "modify",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-27T14:50:03.269Z] [DEBUG] [bodyLLM] structured {
  "answer": "Por favor, proporcione más detalles sobre su solicitud para poder ayudarle mejor. ¿Está buscando confirmar una reserva? Si es así, necesitaría las fechas de check-in y check-out, la cantidad de huéspedes y el tipo de habitación.",
  "intent": "general_question",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar información adicional para confirmar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "checkin_date",
    "checkout_date",
    "guests",
    "room_type"
  ],
  "language": "es"
}
[2025-09-27T14:50:03.269Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:50:03.270Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "nextCategory": "reservation",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: quote",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "CONFIRMAR",
    "category": "reservation",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_flow",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "desiredAction": "modify",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-27T14:50:03.270Z] [DEBUG] [handleIncomingMessage] suggestion ✅ ¡Reserva confirmada! Código **mock-210112**.
Habitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!
[2025-09-27T14:50:03.270Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "602147ae-161e-4040-830b-c11145b26c49",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "suggestion": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
  "timestamp": "2025-09-27T14:50:03.270Z",
  "time": "11:49 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-27T14:50:03.765Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!"
}
[2025-09-27T14:50:08.395Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:50:19.047Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:50:29.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:50:40.512Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:50:51.316Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:51:02.172Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:51:13.085Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:51:24.041Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:51:35.050Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:51:35.051Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:35.072Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:35.078Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:35.092Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:35.106Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:35.117Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:51:46.104Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:51:57.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:52:08.372Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T14:52:19.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:52:30.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:52:42.152Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:52:53.507Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:53:04.914Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:53:16.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:53:27.879Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:53:39.442Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:53:51.047Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:54:02.704Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:54:14.408Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:54:26.167Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:54:37.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:54:49.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:55:01.744Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:55:13.698Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:55:25.705Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:55:37.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:55:37.720Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:55:37.737Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:55:37.749Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:55:37.757Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T14:55:49.728Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:56:01.735Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T14:56:13.743Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:03:16.852Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:03:28.865Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:03:40.871Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:03:52.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:04:04.884Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:04:16.886Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:04:28.900Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:04:40.913Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:04:52.922Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:05:04.929Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:05:16.933Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:05:28.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:05:40.956Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T15:05:52.964Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:06:04.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:06:16.976Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:06:28.990Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:06:41.004Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:06:41.004Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T15:06:41.026Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T15:06:41.041Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T15:06:41.052Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-27T15:06:53.010Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:07:05.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:07:17.021Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:07:29.035Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:07:41.046Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T15:07:53.051Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:08:05.058Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:08:17.062Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-27T15:08:29.071Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-27T22:22:55.821Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T08:24:41.450Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:41.480Z] [WARN] [agentGraph] ⚠️ No graph module found. Using minimal fallback.
[2025-09-29T08:24:41.490Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:41.504Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:41.516Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:41.520Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:42.171Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T08:24:42.202Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T08:24:42.205Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:42.206Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T08:24:42.259Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:42.266Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:775:19
[2025-09-29T08:24:42.298Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T08:24:42.300Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T08:24:42.301Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:24:42.302Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T08:57:09.474Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T08:57:09.486Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:04:43.094Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:04:43.108Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:04:43.122Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:20:24.044Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:20:24.056Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:20:24.062Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:21:17.229Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:21:17.240Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:21:17.250Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:01.353Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:01.365Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:01.371Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:02.197Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:25:02.238Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:25:02.242Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:02.243Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:25:02.318Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:02.328Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:775:19
[2025-09-29T09:25:02.364Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:25:02.366Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:25:02.367Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:25:02.367Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:27:18.226Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:18.251Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:18.257Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:18.962Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:27:18.999Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:27:19.006Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:19.007Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:27:19.060Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:19.077Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:775:19
[2025-09-29T09:27:19.106Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:27:19.108Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:27:19.110Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:27:19.111Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:31:28.875Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:28.891Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:28.899Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:29.717Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:31:29.757Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:31:29.762Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:29.762Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:31:29.824Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:29.840Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:792:19
[2025-09-29T09:31:29.879Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:31:29.881Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:31:29.884Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:31:29.885Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:35:19.296Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:19.310Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:19.317Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:20.027Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:35:20.070Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:35:20.074Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:20.075Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:35:20.138Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:20.148Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:98:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:792:19
[2025-09-29T09:35:20.185Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:35:20.188Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T09:35:20.192Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T09:35:20.192Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T09:59:01.377Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T09:59:02.091Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e9a819ed-2765-425f-a7ee-ed838815a322",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-29T09:59:02.088Z",
    "time": "06:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T09:59:04.130Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "close",
    "updatedAt": "2025-09-27T14:49:58.055Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    },
    "lastReservation": {
      "reservationId": "mock-210112",
      "status": "created",
      "createdAt": "2025-09-27T14:49:58.055Z",
      "channel": "web"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-27T14:49:54.425Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e9a819ed-2765-425f-a7ee-ed838815a322",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "hola",
    "suggestion": "",
    "timestamp": "2025-09-29T09:59:02.088Z",
    "time": "06:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T09:59:04.137Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "close",
      "updatedAt": "2025-09-27T14:49:58.055Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      },
      "lastReservation": {
        "reservationId": "mock-210112",
        "status": "created",
        "createdAt": "2025-09-27T14:49:58.055Z",
        "channel": "web"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-27T14:49:54.425Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:e9a819ed-2765-425f-a7ee-ed838815a322",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "hola",
      "suggestion": "",
      "timestamp": "2025-09-29T09:59:02.088Z",
      "time": "06:59 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-29T09:59:04.138Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: confirmada
[2025-09-29T09:59:04.772Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:05.041Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T09:59:08.219Z] [WARN] ⚠️ Ningún resultado con buena similitud. Reintentando sin filtros...
[2025-09-29T09:59:10.195Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva confirmada, puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "hola",
  "category": "retrieval_based",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-29T09:59:12.685Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T09:59:12.824Z] [DEBUG] [bodyLLM] structured {
  "answer": "¡Hola! Bienvenido al Hotel Demo. ¿En qué puedo ayudarte hoy?",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-29T09:59:12.825Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "¡Hola! ¿En qué puedo ayudarte hoy?",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:12.827Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "¡Hola! ¿En qué puedo ayudarte hoy?",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tengo doble disponible. Tarifa por noche: 100 USD.\n\n¿Confirmás la reserva? Respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva confirmada, puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "hola",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:12.827Z] [DEBUG] [handleIncomingMessage] suggestion ¡Hola! ¿En qué puedo ayudarte hoy?
[2025-09-29T09:59:12.828Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "64c9aa0a-c68f-416e-bf29-2d0e51794e01",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
  "suggestion": "¡Hola! ¿En qué puedo ayudarte hoy?",
  "timestamp": "2025-09-29T09:59:12.828Z",
  "time": "06:59 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-29T09:59:13.130Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "¡Hola! ¿En qué puedo ayudarte hoy?"
}
[2025-09-29T09:59:24.044Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T09:59:35.453Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T09:59:42.519Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fbe1092f-875f-4910-bf19-52d8aa55fee1",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva, no se en que estado quedo?",
    "suggestion": "",
    "timestamp": "2025-09-29T09:59:42.518Z",
    "time": "06:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T09:59:44.160Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "close",
    "updatedAt": "2025-09-27T14:49:58.055Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    },
    "lastReservation": {
      "reservationId": "mock-210112",
      "status": "created",
      "createdAt": "2025-09-27T14:49:58.055Z",
      "channel": "web"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-29T09:59:02.766Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fbe1092f-875f-4910-bf19-52d8aa55fee1",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "creo que tengo una reserva, no se en que estado quedo?",
    "suggestion": "",
    "timestamp": "2025-09-29T09:59:42.518Z",
    "time": "06:59 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T09:59:44.161Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "close",
      "updatedAt": "2025-09-27T14:49:58.055Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      },
      "lastReservation": {
        "reservationId": "mock-210112",
        "status": "created",
        "createdAt": "2025-09-27T14:49:58.055Z",
        "channel": "web"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-29T09:59:02.766Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:fbe1092f-875f-4910-bf19-52d8aa55fee1",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "creo que tengo una reserva, no se en que estado quedo?",
      "suggestion": "",
      "timestamp": "2025-09-29T09:59:42.518Z",
      "time": "06:59 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-29T09:59:44.162Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: confirmada
[2025-09-29T09:59:44.183Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, no se en que estado quedo?",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:44.467Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "creo que tengo una reserva, no se en que estado quedo?",
  "category": "reservation_snapshot",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "promptKey": "reservation_snapshot",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "intentConfidence": 0.99,
  "intentSource": "heuristic",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-29T09:59:46.907Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T09:59:47.918Z] [DEBUG] [bodyLLM] structured {
  "answer": "Para poder ayudarte con el estado de tu reserva, necesitaría que me proporciones el nombre con el que se realizó la reserva o algún otro dato que pueda identificarla. ¿Podrías facilitarme esa información?",
  "intent": "reservation_inquiry",
  "entities": {},
  "actions": [
    {
      "type": "collect_missing_info",
      "detail": "Solicitar información para identificar la reserva."
    }
  ],
  "handoff": false,
  "missing_fields": [
    "contact"
  ],
  "language": "es"
}
[2025-09-29T09:59:47.919Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
  "nextCategory": "reservation_snapshot",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, no se en que estado quedo?",
    "category": "reservation_snapshot",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_snapshot",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.99,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:47.922Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
  "nextCategory": "reservation_snapshot",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2",
    "locale": "es"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Puedo corroborar tu reserva. ¿Me compartís el CÓDIGO de reserva? Si no lo tenés a mano, decime nombre completo y fechas aproximadas (check-in/check-out) para buscarla.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva en proceso,  puedes corroborar?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "creo que tengo una reserva, no se en que estado quedo?",
    "category": "reservation_snapshot",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": "reservation_snapshot",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2",
      "locale": "es"
    },
    "intentConfidence": 0.99,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T09:59:47.923Z] [DEBUG] [handleIncomingMessage] suggestion Tienes una reserva confirmada:

- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Código: mock-210112
[2025-09-29T09:59:47.924Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "4813b2da-4f91-4b10-861e-38fc7bd2a867",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
  "suggestion": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
  "timestamp": "2025-09-29T09:59:47.923Z",
  "time": "06:59 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-29T09:59:48.150Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112"
}
[2025-09-29T09:59:58.410Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:00:00.233Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:764d9fc7-58c2-41b5-a703-83b0bad5f540",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "gracias",
    "suggestion": "",
    "timestamp": "2025-09-29T10:00:00.232Z",
    "time": "07:00 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:00:01.915Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "close",
    "updatedAt": "2025-09-27T14:49:58.055Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    },
    "lastReservation": {
      "reservationId": "mock-210112",
      "status": "created",
      "createdAt": "2025-09-27T14:49:58.055Z",
      "channel": "web"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-29T09:59:43.134Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:764d9fc7-58c2-41b5-a703-83b0bad5f540",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "gracias",
    "suggestion": "",
    "timestamp": "2025-09-29T10:00:00.232Z",
    "time": "07:00 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:00:01.916Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "close",
      "updatedAt": "2025-09-27T14:49:58.055Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      },
      "lastReservation": {
        "reservationId": "mock-210112",
        "status": "created",
        "createdAt": "2025-09-27T14:49:58.055Z",
        "channel": "web"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-29T09:59:43.134Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:764d9fc7-58c2-41b5-a703-83b0bad5f540",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "gracias",
      "suggestion": "",
      "timestamp": "2025-09-29T10:00:00.232Z",
      "time": "07:00 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-29T10:00:01.917Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: confirmada
[2025-09-29T10:00:01.930Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "gracias",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:02.162Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:00:05.934Z] [WARN] ⚠️ Ningún resultado con buena similitud. Reintentando sin filtros...
[2025-09-29T10:00:08.933Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "CONFIRMAR",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "gracias",
  "category": "retrieval_based",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-29T10:00:09.963Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:00:11.498Z] [DEBUG] [bodyLLM] structured {
  "answer": "¡De nada! Si necesitas más información o asistencia, no dudes en preguntar. Estoy aquí para ayudarte.",
  "intent": "general_question",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-29T10:00:11.499Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "gracias",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:11.500Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tu solicitud de reserva está en curso (aún no confirmada).\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n\nPara confirmar, respondé “CONFIRMAR”.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "CONFIRMAR",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "gracias",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:11.501Z] [DEBUG] [handleIncomingMessage] suggestion De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.
[2025-09-29T10:00:11.501Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "5238a6d9-314d-46a4-9ec7-c4dac094bbe8",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
  "suggestion": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
  "timestamp": "2025-09-29T10:00:11.501Z",
  "time": "07:00 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-29T10:00:11.701Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte."
}
[2025-09-29T10:00:21.566Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:00:30.033Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4f411ef9-6413-4be1-89b3-c477af1ec680",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "a que hora es el check in",
    "suggestion": "",
    "timestamp": "2025-09-29T10:00:30.032Z",
    "time": "07:00 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:00:31.875Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "close",
    "updatedAt": "2025-09-27T14:49:58.055Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    },
    "lastReservation": {
      "reservationId": "mock-210112",
      "status": "created",
      "createdAt": "2025-09-27T14:49:58.055Z",
      "channel": "web"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-29T10:00:00.908Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4f411ef9-6413-4be1-89b3-c477af1ec680",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "a que hora es el check in",
    "suggestion": "",
    "timestamp": "2025-09-29T10:00:30.032Z",
    "time": "07:00 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:00:31.876Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "close",
      "updatedAt": "2025-09-27T14:49:58.055Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      },
      "lastReservation": {
        "reservationId": "mock-210112",
        "status": "created",
        "createdAt": "2025-09-27T14:49:58.055Z",
        "channel": "web"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-29T10:00:00.908Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:4f411ef9-6413-4be1-89b3-c477af1ec680",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "a que hora es el check in",
      "suggestion": "",
      "timestamp": "2025-09-29T10:00:30.032Z",
      "time": "07:00 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-29T10:00:31.876Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: confirmada
[2025-09-29T10:00:31.883Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "a que hora es el check in",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:32.078Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:00:33.220Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:00:35.458Z] [WARN] ⚠️ Ningún resultado con buena similitud. Reintentando sin filtros...
[2025-09-29T10:00:37.411Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "hola",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "El check-in es hasta la 1 pm.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "a que hora es el check in",
  "category": "retrieval_based",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-29T10:00:40.700Z] [DEBUG] [bodyLLM] structured {
  "answer": "El horario de check-in en el Hotel Demo es a partir de las 15:00 horas. Si necesitas más información, no dudes en preguntar.",
  "intent": "checkin_info",
  "entities": {},
  "actions": [],
  "handoff": false,
  "missing_fields": [],
  "language": "es"
}
[2025-09-29T10:00:40.701Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "El check-in es hasta la 1 pm.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "a que hora es el check in",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:40.702Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "El check-in es hasta la 1 pm.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": false,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "✅ ¡Reserva confirmada! Código **mock-210112**.\nHabitación **doble**, Fechas **2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z** · **2** huésped(es). ¡Gracias, Marcelo Martinez!",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "hola",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "a que hora es el check in",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:00:40.703Z] [DEBUG] [handleIncomingMessage] suggestion El check-in es hasta la 1 pm.
[2025-09-29T10:00:40.703Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "c3ed1779-6b62-4da2-aa32-35948ce97f1e",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "El check-in es hasta la 1 pm.",
  "suggestion": "El check-in es hasta la 1 pm.",
  "timestamp": "2025-09-29T10:00:40.703Z",
  "time": "07:00 a. m.",
  "status": "sent",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web"
}
[2025-09-29T10:00:40.874Z] [DEBUG] [handleIncomingMessage] emitReply sent {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "suggestion": "El check-in es hasta la 1 pm."
}
[2025-09-29T10:00:44.923Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:00:56.677Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:01:08.484Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:01:20.342Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:01:32.254Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:01:44.213Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:01:56.224Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:02:08.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:02:08.235Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:02:08.265Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:02:08.304Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:02:08.337Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:02:20.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:02:22.259Z] [DEBUG] [handleIncomingMessage] IN {
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:139f9ab9-1bcb-453b-a5c8-ef10d1ec5179",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
    "suggestion": "",
    "timestamp": "2025-09-29T10:02:22.259Z",
    "time": "07:02 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:02:23.909Z] [DEBUG] [handleIncomingMessage] preLLM/pre {
  "lang": "es",
  "currSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "prevCategory": null,
  "prevSlotsStrict": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "st": {
    "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "hotelId": "hotel999",
    "reservationSlots": {
      "locale": "es",
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "salesStage": "close",
    "updatedAt": "2025-09-27T14:49:58.055Z",
    "updatedBy": "ai",
    "lastProposal": {
      "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
      "available": true,
      "options": [
        {
          "roomType": "double",
          "pricePerNight": 100,
          "currency": "USD",
          "policies": "Cancelación flexible",
          "availability": 3
        }
      ],
      "toolCall": {
        "name": "checkAvailability",
        "input": {
          "hotelId": "hotel999",
          "roomType": "double",
          "numGuests": 2,
          "checkIn": "2025-10-02T00:00:00Z",
          "checkOut": "2025-10-04T00:00:00Z"
        },
        "outputSummary": "available:true",
        "at": "2025-09-27T14:16:30.535Z"
      }
    },
    "lastReservation": {
      "reservationId": "mock-210112",
      "status": "created",
      "createdAt": "2025-09-27T14:49:58.055Z",
      "channel": "web"
    }
  },
  "stateForPlaybook": {
    "draft": null,
    "confirmedBooking": null,
    "locale": "es"
  },
  "intent": "general_question",
  "inModifyMode": false,
  "hasDraftOrConfirmed": false,
  "promptKey": "default",
  "systemInstruction": "Eres un asistente de reservas de hotel.",
  "lcHistory": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "El check-in es hasta la 1 pm.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "hints": [],
  "draftExists": false,
  "guest": {
    "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
    "guestId": "web-guest",
    "hotelId": "hotel999",
    "name": "Hola",
    "mode": "automatic",
    "createdAt": "2025-08-27T11:58:38.331Z",
    "updatedAt": "2025-09-29T10:00:30.747Z"
  },
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "msg": {
    "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:139f9ab9-1bcb-453b-a5c8-ef10d1ec5179",
    "hotelId": "hotel999",
    "channel": "web",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "sender": "guest",
    "guestId": "web-guest",
    "role": "user",
    "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
    "suggestion": "",
    "timestamp": "2025-09-29T10:02:22.259Z",
    "time": "07:02 a. m.",
    "status": "sent",
    "detectedLanguage": "es",
    "direction": "in",
    "sourceProvider": "web"
  },
  "options": {
    "mode": "automatic"
  }
}
[2025-09-29T10:02:23.910Z] [DEBUG] [bodyLLM] IN {
  "pre": {
    "lang": "es",
    "currSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "prevCategory": null,
    "prevSlotsStrict": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "st": {
      "_id": "hotel999:09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "hotelId": "hotel999",
      "reservationSlots": {
        "locale": "es",
        "guestName": "Marcelo Martinez",
        "roomType": "double",
        "checkIn": "2025-10-02T00:00:00Z",
        "checkOut": "2025-10-04T00:00:00Z",
        "numGuests": "2"
      },
      "salesStage": "close",
      "updatedAt": "2025-09-27T14:49:58.055Z",
      "updatedBy": "ai",
      "lastProposal": {
        "text": "Tengo doble disponible. Tarifa por noche: 100 USD.",
        "available": true,
        "options": [
          {
            "roomType": "double",
            "pricePerNight": 100,
            "currency": "USD",
            "policies": "Cancelación flexible",
            "availability": 3
          }
        ],
        "toolCall": {
          "name": "checkAvailability",
          "input": {
            "hotelId": "hotel999",
            "roomType": "double",
            "numGuests": 2,
            "checkIn": "2025-10-02T00:00:00Z",
            "checkOut": "2025-10-04T00:00:00Z"
          },
          "outputSummary": "available:true",
          "at": "2025-09-27T14:16:30.535Z"
        }
      },
      "lastReservation": {
        "reservationId": "mock-210112",
        "status": "created",
        "createdAt": "2025-09-27T14:49:58.055Z",
        "channel": "web"
      }
    },
    "stateForPlaybook": {
      "draft": null,
      "confirmedBooking": null,
      "locale": "es"
    },
    "intent": "general_question",
    "inModifyMode": false,
    "hasDraftOrConfirmed": false,
    "promptKey": "default",
    "systemInstruction": "Eres un asistente de reservas de hotel.",
    "lcHistory": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "hints": [],
    "draftExists": false,
    "guest": {
      "_id": "45eef3da-d6dd-4b8e-aef3-dad6ddeb8e89",
      "guestId": "web-guest",
      "hotelId": "hotel999",
      "name": "Hola",
      "mode": "automatic",
      "createdAt": "2025-08-27T11:58:38.331Z",
      "updatedAt": "2025-09-29T10:00:30.747Z"
    },
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "msg": {
      "messageId": "web:09ea8a53-48a4-4a26-b8fb-d51630c735c3:139f9ab9-1bcb-453b-a5c8-ef10d1ec5179",
      "hotelId": "hotel999",
      "channel": "web",
      "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
      "sender": "guest",
      "guestId": "web-guest",
      "role": "user",
      "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
      "suggestion": "",
      "timestamp": "2025-09-29T10:02:22.259Z",
      "time": "07:02 a. m.",
      "status": "sent",
      "detectedLanguage": "es",
      "direction": "in",
      "sourceProvider": "web"
    },
    "options": {
      "mode": "automatic"
    }
  }
}
[2025-09-29T10:02:23.910Z] [DEBUG] [bodyLLM] systemInstruction Eres un asistente de reservas de hotel.
Estado actual de la reserva:
- Nombre: Marcelo Martinez
- Habitación: double
- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z
- Huéspedes: 2
- Estado: confirmada
[2025-09-29T10:02:23.918Z] [DEBUG] [Graph] Enter classifyNode {
  "state": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
    "category": "other",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "promptKey": null,
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:02:24.086Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:02:26.149Z] [WARN] ⚠️ Ningún resultado con buena similitud. Reintentando sin filtros...
[2025-09-29T10:02:29.130Z] [DEBUG] [bodyLLM] graphResult {
  "messages": [
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "El check-in es hasta la 1 pm.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "SystemMessage"
      ],
      "kwargs": {
        "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "creo que tengo una reserva, no se en que estado quedo?",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "gracias",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "a que hora es el check in",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "El check-in es hasta la 1 pm.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "HumanMessage"
      ],
      "kwargs": {
        "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
        "additional_kwargs": {},
        "response_metadata": {}
      }
    },
    {
      "lc": 1,
      "type": "constructor",
      "id": [
        "langchain_core",
        "messages",
        "AIMessage"
      ],
      "kwargs": {
        "content": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
        "tool_calls": [],
        "invalid_tool_calls": [],
        "additional_kwargs": {},
        "response_metadata": {}
      }
    }
  ],
  "normalizedMessage": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
  "category": "retrieval_based",
  "detectedLanguage": "es",
  "sentiment": "neutral",
  "preferredLanguage": "es",
  "hotelId": "hotel999",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "meta": {
    "channel": "web",
    "prevCategory": null
  },
  "reservationSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "intentConfidence": 0.95,
  "intentSource": "heuristic",
  "salesStage": "close",
  "lastOffer": null,
  "upsellCount": 0
}
[2025-09-29T10:02:31.682Z] [DEBUG] [bodyLLM] structured {
  "answer": "Lamentablemente, no tengo información sobre opciones de movilidad desde el aeropuerto más cercano al Hotel Demo. Te recomiendo consultar con la recepción del hotel para obtener detalles específicos sobre transporte. Si necesitas más ayuda, no dudes en preguntar.",
  "intent": "out_of_scope",
  "entities": {},
  "actions": [],
  "handoff": true,
  "missing_fields": [],
  "language": "es"
}
[2025-09-29T10:02:31.683Z] [DEBUG] [bodyLLM] OUT {
  "finalText": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:02:31.684Z] [DEBUG] [handleIncomingMessage] bodyLLM/body {
  "finalText": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
  "nextCategory": "retrieval_based",
  "nextSlots": {
    "guestName": "Marcelo Martinez",
    "roomType": "double",
    "checkIn": "2025-10-02T00:00:00Z",
    "checkOut": "2025-10-04T00:00:00Z",
    "numGuests": "2"
  },
  "needsSupervision": true,
  "graphResult": {
    "messages": [
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "SystemMessage"
        ],
        "kwargs": {
          "content": "Eres un asistente de reservas de hotel.\nEstado actual de la reserva:\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Estado: confirmada",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "¡Hola! ¿En qué puedo ayudarte hoy?",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "creo que tengo una reserva, no se en que estado quedo?",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "Tienes una reserva confirmada:\n\n- Nombre: Marcelo Martinez\n- Habitación: double\n- Fechas: 2025-10-02T00:00:00Z → 2025-10-04T00:00:00Z\n- Huéspedes: 2\n- Código: mock-210112",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "gracias",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "De nada. Si tienes alguna otra pregunta o necesitas más información, no dudes en preguntar. Estoy aquí para ayudarte.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "a que hora es el check in",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El check-in es hasta la 1 pm.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "HumanMessage"
        ],
        "kwargs": {
          "content": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
          "additional_kwargs": {},
          "response_metadata": {}
        }
      },
      {
        "lc": 1,
        "type": "constructor",
        "id": [
          "langchain_core",
          "messages",
          "AIMessage"
        ],
        "kwargs": {
          "content": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
          "tool_calls": [],
          "invalid_tool_calls": [],
          "additional_kwargs": {},
          "response_metadata": {}
        }
      }
    ],
    "normalizedMessage": "que movilidad tengo para trasladarme desde el aeropuerto mas cercano al hotel",
    "category": "retrieval_based",
    "detectedLanguage": "es",
    "sentiment": "neutral",
    "preferredLanguage": "es",
    "hotelId": "hotel999",
    "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
    "meta": {
      "channel": "web",
      "prevCategory": null
    },
    "reservationSlots": {
      "guestName": "Marcelo Martinez",
      "roomType": "double",
      "checkIn": "2025-10-02T00:00:00Z",
      "checkOut": "2025-10-04T00:00:00Z",
      "numGuests": "2"
    },
    "intentConfidence": 0.95,
    "intentSource": "heuristic",
    "salesStage": "close",
    "lastOffer": null,
    "upsellCount": 0
  }
}
[2025-09-29T10:02:31.685Z] [DEBUG] [handleIncomingMessage] suggestion El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.
[2025-09-29T10:02:31.686Z] [DEBUG] [handleIncomingMessage] aiMsg {
  "messageId": "0f6c1a28-47f1-4217-884c-ed2af6a0d232",
  "hotelId": "hotel999",
  "channel": "web",
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3",
  "sender": "assistant",
  "guestId": "web-guest",
  "role": "ai",
  "content": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
  "suggestion": "El Hotel Demó está ubicado a solo 100 metros de la terminal de autobuses para los aeropuertos de Linate, Malpensa y Bergamo Orio al Serio, ubicada junto a la Estación Central de Milán. Esto significa que puedes tomar un autobús desde cualquiera de estos aeropuertos directamente a la terminal cercana al hotel.",
  "timestamp": "2025-09-29T10:02:31.686Z",
  "time": "07:02 a. m.",
  "status": "pending",
  "detectedLanguage": "es",
  "direction": "in",
  "sourceProvider": "web",
  "respondedBy": "assistant"
}
[2025-09-29T10:02:31.884Z] [DEBUG] [handleIncomingMessage] emitReply pending {
  "conversationId": "09ea8a53-48a4-4a26-b8fb-d51630c735c3"
}
[2025-09-29T10:02:32.242Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:02:44.244Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:02:56.248Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:03:08.255Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:03:20.264Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:03:32.277Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:03:44.283Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:03:56.292Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:04:08.299Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:04:20.307Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:04:32.318Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:04:44.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:04:56.339Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:05:08.347Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:05:20.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:05:32.370Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:05:44.384Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:05:56.392Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:06:08.399Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:06:20.407Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:06:20.409Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:06:20.450Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:06:20.474Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:06:20.503Z] [ERROR]  [31m[1m⨯[22m[39m {}
[2025-09-29T10:06:32.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:06:44.431Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:06:56.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:07:08.447Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:07:20.455Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:07:32.468Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:07:44.482Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:07:56.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:08:08.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:08:20.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:08:32.514Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:08:44.526Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:08:56.533Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:09:08.540Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:09:20.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:09:32.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:09:44.563Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:09:56.573Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:10:08.582Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:10:20.588Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:10:32.600Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:10:44.613Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:10:56.624Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:11:08.631Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:11:20.640Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:11:32.654Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:11:44.667Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:11:56.678Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:12:08.684Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:12:20.694Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:12:32.707Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:12:44.720Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:12:56.730Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:13:08.736Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:13:20.744Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:13:32.748Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:13:44.758Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:13:56.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:14:08.774Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:14:20.782Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:14:32.796Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:14:44.808Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:14:56.818Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:15:08.824Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:15:20.832Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:15:32.847Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:15:44.860Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:15:56.869Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:16:08.875Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:16:10.925Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:10.940Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:10.946Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:11.706Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:16:11.743Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:16:11.746Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:11.747Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:16:11.836Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:11.855Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:118:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:812:19
[2025-09-29T10:16:11.884Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:16:11.886Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:16:11.888Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:16:11.888Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:16:20.883Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:16:32.888Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:16:44.900Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:16:56.907Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:17:08.914Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:17:20.881Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:20.894Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:20.898Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:20.918Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:17:21.536Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:17:21.576Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:17:21.579Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:21.579Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:17:21.642Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:21.652Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:118:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:814:19
[2025-09-29T10:17:21.680Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:17:21.683Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:17:21.685Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:17:21.686Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:17:32.932Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:17:44.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:17:56.956Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:18:08.964Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:18:20.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:18:32.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:18:44.997Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:18:56.999Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:19:09.007Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:19:21.015Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:19:33.028Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:19:45.040Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:19:57.048Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:20:09.054Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:20:21.062Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:20:33.075Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:20:45.088Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:20:57.094Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:21:09.099Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:21:21.107Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:21:31.203Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.209Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.212Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.630Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:21:31.653Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:21:31.656Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.656Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:21:31.690Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.697Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:118:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:814:19
[2025-09-29T10:21:31.717Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:21:31.718Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:21:31.722Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:21:31.723Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:21:33.112Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:21:45.124Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:21:57.131Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:22:09.138Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:22:21.145Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:22:33.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:22:45.171Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:22:57.177Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:23:09.181Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:23:21.189Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:23:33.203Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:23:45.216Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:23:57.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:24:09.227Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:24:21.234Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:24:33.247Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:24:45.259Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:24:57.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:25:09.273Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:25:21.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:25:33.294Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:25:45.306Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:25:57.313Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:26:09.319Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:26:21.326Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:26:30.579Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:30.588Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:30.592Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:30.983Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:26:31.006Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:26:31.008Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:31.009Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:26:31.044Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:31.051Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:118:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:814:19
[2025-09-29T10:26:31.065Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:26:31.066Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:26:31.067Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:26:31.068Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:26:33.332Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:26:45.343Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:26:57.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:27:09.358Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:27:21.365Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:27:33.379Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:27:45.388Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:27:57.394Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:28:09.401Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:28:21.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:28:33.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:28:45.435Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:28:57.443Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:29:09.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:29:21.457Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:29:33.469Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:29:45.482Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:29:57.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:30:09.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:30:21.505Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:30:33.519Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:30:45.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:30:57.539Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:31:09.545Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:31:21.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:31:33.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:31:45.573Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:31:57.580Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:32:09.587Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:32:21.595Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:32:33.608Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:32:45.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:32:57.626Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:33:09.634Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:33:21.643Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:33:33.657Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:33:45.668Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:33:57.675Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:34:09.682Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:34:21.688Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:34:33.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:34:45.715Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:34:57.723Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:35:09.729Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:35:21.735Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:35:33.748Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:35:45.761Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:35:57.768Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:36:09.774Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:36:21.782Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:36:33.793Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:36:45.803Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:36:57.811Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:37:09.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:37:21.826Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:37:33.837Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:37:45.850Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:37:57.858Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:38:09.864Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:38:21.867Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:38:33.880Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:38:45.892Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:38:57.901Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:39:09.908Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:39:21.916Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:39:33.924Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:39:45.930Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:39:57.933Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:40:09.941Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:40:21.950Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:40:33.962Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:40:45.976Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:40:57.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:41:09.991Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:41:11.287Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.295Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.300Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.779Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:41:11.803Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:41:11.807Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.808Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:41:11.852Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.858Z] [ERROR] [/api/chat] error: Error: idempotent
    at getObjectiveContext (/home/marcelo/begasist/lib/handlers/messageHandler.ts:118:94)
    at /home/marcelo/begasist/lib/handlers/messageHandler.ts:814:19
[2025-09-29T10:41:11.888Z] [WARN] ⚠️ [searchFromAstra] hotelId no proporcionado, usando fallback: 'hotel999'
[2025-09-29T10:41:11.889Z] [ERROR] ❌ [messageHandler] agentGraph error: {
  "errMsg": "The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' })."
}
[2025-09-29T10:41:11.891Z] [WARN] [structured] fallback/analysis error: The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).
[2025-09-29T10:41:11.891Z] [WARN] ⚠️ [graph] finalText vacío → fallback determinista
[2025-09-29T10:41:21.996Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:41:34.010Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:41:46.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:41:58.031Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:42:10.037Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:42:22.041Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:42:34.057Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:42:46.071Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:42:58.078Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:43:10.085Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:43:22.088Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:43:34.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:43:46.112Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:43:58.121Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:44:10.127Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:44:22.132Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:44:34.145Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:44:46.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:44:58.167Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:45:10.174Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:45:22.178Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:45:34.192Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:45:46.206Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:45:58.215Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:46:10.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:46:22.227Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:46:34.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:46:46.249Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:46:58.258Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:47:10.265Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:47:22.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:47:34.283Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:47:46.295Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:47:58.305Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:48:10.310Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:48:22.313Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:48:34.323Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:48:46.332Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:48:58.342Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:49:10.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:49:22.352Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:49:34.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:49:46.373Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:49:58.381Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:50:10.387Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:50:22.392Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:50:34.398Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:50:46.412Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:50:58.421Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:51:10.429Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:51:22.433Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:51:34.443Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:51:46.457Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:51:58.467Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:52:10.475Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:52:22.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:52:34.490Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:52:46.502Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:52:58.510Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:53:10.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:53:22.520Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:53:34.533Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:53:46.543Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:53:58.551Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:54:10.558Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:54:22.563Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:54:34.576Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:54:46.588Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:54:58.598Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:55:10.604Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:55:22.609Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:55:34.623Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:55:46.638Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:55:58.648Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:56:10.654Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:56:22.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:56:34.673Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:56:46.690Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:56:58.698Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:57:10.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:57:22.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:57:34.718Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:57:46.733Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:57:58.742Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:58:10.749Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:58:22.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:58:34.763Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T10:58:46.775Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:58:58.785Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:59:10.793Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:59:22.800Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:59:34.814Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:59:46.827Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T10:59:58.836Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:00:10.844Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:00:22.848Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:00:34.863Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:00:46.876Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:00:58.886Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:01:10.892Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:01:22.896Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:01:34.909Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:01:46.922Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:01:58.932Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:02:10.938Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:02:22.943Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:02:34.956Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:02:46.970Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:02:58.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:03:10.987Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:03:22.991Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:03:35.003Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:03:47.016Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:03:59.027Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:04:11.034Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:04:23.038Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:04:35.052Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:04:47.066Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:04:59.076Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:05:11.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:05:23.089Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:05:35.103Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:05:47.117Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:05:59.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:06:11.133Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:06:23.138Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:06:35.150Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:06:47.162Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:06:59.172Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:07:11.180Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:07:23.185Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:07:35.200Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:07:47.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:07:59.224Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:08:11.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:08:23.235Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:08:35.249Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:08:47.263Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:08:59.274Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:09:11.282Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:09:23.286Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:09:35.298Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:09:47.312Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:09:59.323Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:10:11.331Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:10:23.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:10:35.346Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:10:47.359Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:10:59.371Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:11:11.379Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:11:23.384Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:11:35.397Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:11:47.411Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:11:59.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:12:11.432Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:12:23.436Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:12:35.451Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:12:47.455Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:12:59.465Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:13:11.473Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:13:23.479Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:13:35.492Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:13:47.496Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:13:59.507Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:14:11.514Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:14:23.519Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:14:35.526Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:14:47.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:14:59.542Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:15:11.549Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:15:23.555Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:15:35.568Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:15:47.571Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:15:59.578Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:16:11.585Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:16:23.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:16:35.606Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:16:47.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:16:59.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:17:11.626Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:17:23.631Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:17:35.645Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:17:47.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:17:59.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:18:11.667Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:18:23.671Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:18:35.685Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:18:47.687Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:18:59.699Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:19:11.707Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:19:23.711Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:19:35.725Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:19:47.727Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:19:59.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:20:11.745Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:20:23.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:20:35.764Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:20:47.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:20:59.778Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:21:11.786Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:21:23.791Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:21:35.805Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:21:47.808Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:21:59.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:22:11.824Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:22:23.830Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:22:35.843Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:22:47.846Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:22:59.856Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:23:11.865Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:23:23.869Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:23:35.883Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:23:47.885Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:23:59.896Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:24:11.904Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:24:23.909Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:24:35.923Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:24:47.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:24:59.935Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:25:11.944Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:25:23.949Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:25:35.962Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:25:47.965Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:25:59.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:26:11.986Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:26:23.991Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:26:36.005Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:26:48.007Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:27:00.019Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:27:12.027Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:27:24.032Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:27:36.043Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:27:48.045Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:28:00.056Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:28:12.065Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:28:24.070Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:28:36.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:28:48.086Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:29:00.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:29:12.106Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:29:24.111Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:29:36.120Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:29:48.123Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:30:00.135Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:30:12.144Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:30:24.150Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:30:36.163Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:30:48.165Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:31:00.176Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:31:12.183Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:31:24.188Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:31:36.198Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:31:48.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:32:00.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:32:12.219Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:32:24.224Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:32:36.233Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:32:48.236Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:33:00.246Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:33:12.254Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:33:24.260Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:33:36.273Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:33:48.276Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:34:00.287Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:34:12.296Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:34:24.301Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:34:36.311Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:34:48.312Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:35:00.324Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:35:12.331Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:35:24.337Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:35:36.352Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:35:48.353Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:36:00.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:36:12.372Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:36:24.378Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:36:36.391Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:36:48.394Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:37:00.406Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:37:12.415Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:37:24.421Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:37:36.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:37:48.437Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:38:00.446Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:38:12.457Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:38:24.462Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:38:36.476Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:38:48.479Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:39:00.489Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:39:12.498Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:39:24.504Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:39:36.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:39:48.511Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:40:00.523Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:40:12.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:40:24.535Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:40:36.549Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:40:48.551Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:41:00.563Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:41:12.571Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:41:24.575Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:41:36.591Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:41:48.594Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:42:00.605Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:42:12.614Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:42:24.620Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:42:36.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:42:48.637Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:43:00.649Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:43:12.658Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:43:24.664Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:43:36.677Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:43:48.680Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:44:00.690Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:44:12.699Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:44:24.703Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:44:36.717Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:44:48.720Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:45:00.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:45:12.740Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:45:24.746Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:45:36.759Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:45:48.761Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:46:00.771Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:46:12.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:46:24.786Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:46:36.800Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:46:48.804Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:47:00.816Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:47:12.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:47:24.831Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:47:36.845Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:47:48.849Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:48:00.860Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:48:12.870Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:48:24.875Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:48:36.889Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:48:48.892Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:49:00.903Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:49:12.911Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:49:24.917Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:49:36.928Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:49:48.932Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:50:00.942Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:50:12.951Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:50:24.957Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:50:36.970Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:50:48.975Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:51:00.988Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:51:12.996Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:51:25.003Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:51:37.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:51:49.020Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:52:01.030Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:52:13.038Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:52:25.044Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:52:37.057Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:52:49.060Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:53:01.069Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:53:13.079Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:53:25.083Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:53:37.097Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:53:49.101Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:54:01.112Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:54:13.120Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:54:25.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:54:37.138Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:54:49.141Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:55:01.153Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:55:13.162Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:55:25.168Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:55:37.184Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:55:49.187Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:56:01.198Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:56:13.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:56:25.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:56:37.227Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:56:49.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:57:01.243Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:57:13.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:57:25.257Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:57:37.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:57:49.273Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:58:01.283Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:58:13.291Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:58:25.298Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:58:37.312Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:58:49.318Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:59:01.331Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:59:13.341Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:59:25.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T11:59:37.358Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T11:59:49.361Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:00:01.373Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:00:13.382Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:00:25.387Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:00:37.400Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:00:49.404Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:01:01.417Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:01:13.426Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:01:25.432Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:01:37.446Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:01:49.450Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:02:01.461Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:02:13.469Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:02:25.474Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:02:37.487Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:02:49.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:03:01.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:03:13.514Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:03:25.520Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:03:37.524Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:03:49.528Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:04:01.540Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:04:13.549Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:04:25.555Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:04:37.562Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:04:49.567Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:05:01.580Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:05:13.588Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:05:25.594Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:05:37.607Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:05:49.613Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:06:01.625Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:06:13.634Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:06:25.640Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:06:37.654Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:06:49.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:07:01.669Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:07:13.678Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:07:25.685Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:07:37.699Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:07:49.704Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:08:01.717Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:08:13.727Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:08:25.733Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:08:37.746Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:08:49.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:09:01.762Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:09:13.772Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:09:25.779Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:09:37.792Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:09:49.796Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:10:01.808Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:10:13.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:10:25.823Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:10:37.833Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:10:49.836Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:11:01.847Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:11:13.856Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:11:25.863Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:11:37.877Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:11:49.882Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:12:01.893Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:12:13.902Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:12:25.907Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:12:37.920Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:12:49.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:13:01.939Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:13:13.949Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:13:25.956Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:13:37.969Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:13:49.975Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:14:01.988Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:14:13.997Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:14:26.003Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:14:38.018Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:14:50.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:15:02.036Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:15:14.045Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:15:26.053Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:15:38.067Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:15:50.072Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:16:02.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:16:14.093Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:16:26.100Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:16:38.113Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:16:50.118Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:17:02.130Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:17:14.139Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:17:26.146Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:17:38.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:17:50.165Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:18:02.178Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:18:14.188Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:18:26.195Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:18:38.209Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:18:50.215Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:19:02.228Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:19:14.237Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:19:26.243Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:19:38.256Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:19:50.260Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:20:02.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:20:14.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:20:26.287Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:20:38.301Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:20:50.307Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:21:02.320Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:21:14.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:21:26.337Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:21:38.350Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:21:50.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:22:02.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:22:14.380Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:22:26.386Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:22:38.400Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:22:50.406Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:23:02.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:23:14.427Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:23:26.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:23:38.448Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:23:50.454Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:24:02.468Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:24:14.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:24:26.484Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:24:38.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:24:50.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:25:02.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:25:14.525Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:25:26.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:25:38.536Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:25:50.542Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:26:02.553Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:26:14.562Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:26:26.570Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:26:38.574Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:26:50.580Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:27:02.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:27:14.604Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:27:26.611Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:27:38.615Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:27:50.622Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:28:02.635Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:28:14.645Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:28:26.652Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:28:38.656Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:28:50.662Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:29:02.675Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:29:14.685Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:29:26.693Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:29:38.696Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:29:50.704Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:30:02.716Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:30:14.726Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:30:26.734Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:30:38.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:30:50.743Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:31:02.757Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:31:14.765Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:31:26.772Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:31:38.774Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:31:50.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:32:02.793Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:32:14.803Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:32:26.810Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:32:38.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:32:50.821Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:33:02.833Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:33:14.844Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:33:26.850Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:33:38.854Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:33:50.860Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:34:02.872Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:34:14.881Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:34:26.889Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:34:38.894Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:34:50.901Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:35:02.907Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:35:14.917Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:35:26.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:35:38.930Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:35:50.937Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:36:02.949Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:36:14.958Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:36:26.964Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:36:38.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:36:50.974Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:37:02.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:37:14.996Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:37:27.001Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:37:39.005Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:37:51.012Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:38:03.025Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:38:15.036Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:38:27.042Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:38:39.045Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:38:51.052Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:39:03.067Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:39:15.078Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:39:27.085Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:39:39.090Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:39:51.095Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:40:03.108Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:40:15.119Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:40:27.127Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:40:39.131Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:40:51.137Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:41:03.152Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:41:15.158Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:41:27.166Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:41:39.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:41:51.177Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:42:03.191Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:42:15.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:42:27.209Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:42:39.214Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:42:51.219Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:43:03.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:43:15.239Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:43:27.245Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:43:39.249Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:43:51.256Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:44:03.270Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:44:15.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:44:27.288Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:44:39.291Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:44:51.297Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:45:03.310Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:45:15.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:45:27.328Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:45:39.332Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:45:51.340Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:46:03.353Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:46:15.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:46:27.372Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:46:39.375Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:46:51.382Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:47:03.393Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T12:47:15.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:47:27.410Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:47:39.415Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:47:51.422Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:48:03.436Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:48:15.447Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:48:27.455Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:48:39.459Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:48:51.466Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:49:03.480Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:49:15.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:49:27.498Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:49:39.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:49:51.511Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:50:03.524Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:50:15.535Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:50:27.542Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:50:39.546Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:50:51.552Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:51:03.563Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:51:15.572Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:51:27.579Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:51:39.582Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:51:51.588Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:52:03.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:52:15.612Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:52:27.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:52:39.623Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:52:51.630Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:53:03.643Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:53:15.654Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:53:27.662Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:53:39.667Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:53:51.673Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:54:03.686Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:54:15.697Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:54:27.705Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:54:39.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:54:51.716Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:55:03.730Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:55:15.740Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:55:27.747Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:55:39.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:55:51.757Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:56:03.770Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:56:15.781Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:56:27.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:56:39.793Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:56:51.801Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:57:03.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:57:15.826Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:57:27.834Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:57:39.839Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:57:51.846Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:58:03.859Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:58:15.870Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:58:27.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:58:39.882Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:58:51.889Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:59:03.903Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:59:15.914Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:59:27.922Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:59:39.927Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T12:59:51.934Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:00:03.948Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:00:15.958Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:00:27.966Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:00:39.970Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:00:51.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:01:03.987Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:01:15.998Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:01:28.006Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:01:40.010Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:01:52.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:02:04.031Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:02:16.041Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:02:28.049Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:02:40.053Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:02:52.058Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:03:04.072Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:03:16.083Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:03:28.091Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:03:40.096Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:03:52.103Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:04:04.116Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:04:16.127Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:04:28.135Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:04:40.139Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:04:52.147Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:05:04.161Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:05:16.172Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:05:28.179Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:05:40.182Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:05:52.189Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:06:04.203Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:06:16.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:06:28.215Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:06:40.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:06:52.227Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:07:04.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:07:16.250Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:07:28.258Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:07:40.263Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:07:52.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:08:04.285Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:08:16.296Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:08:28.304Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:08:40.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:08:52.317Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:09:04.330Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:09:16.339Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:09:28.347Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:09:40.352Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:09:52.360Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:10:04.374Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:10:16.385Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:10:28.394Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:10:40.398Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:10:52.406Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:11:04.413Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:11:16.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:11:28.431Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:11:40.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:11:52.442Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:12:04.454Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:12:16.464Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:12:28.471Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:12:40.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:12:52.485Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:13:04.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:13:16.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:13:28.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:13:40.522Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:13:52.528Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:14:04.540Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:14:16.552Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:14:28.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:14:40.565Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:14:52.568Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:15:04.578Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:15:16.587Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:15:28.595Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:15:40.600Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:15:52.609Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:16:04.621Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:16:16.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:16:28.641Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:16:40.645Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:16:52.653Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:17:04.665Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:17:16.674Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:17:28.682Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:17:40.686Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:17:52.694Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:18:04.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:18:16.718Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:18:28.726Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:18:40.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:18:52.740Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:19:04.748Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:19:16.759Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:19:28.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:19:40.772Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:19:52.779Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:20:04.791Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:20:16.803Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:20:28.809Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:20:40.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:20:52.824Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:21:04.837Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:21:16.849Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:21:28.856Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:21:40.860Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:21:52.869Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:22:04.881Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:22:16.893Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:22:28.899Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:22:40.905Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:22:52.914Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:23:04.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:23:16.936Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:23:28.942Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:23:40.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:23:52.953Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:24:04.965Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:24:16.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:24:28.983Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:24:40.989Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:24:52.996Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:25:05.008Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:25:17.018Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:25:29.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:25:41.028Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:25:53.035Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:26:05.043Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:26:17.054Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:26:29.060Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:26:41.066Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:26:53.074Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:27:05.086Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:27:17.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:27:29.106Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:27:41.112Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:27:53.120Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:28:05.133Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:28:17.142Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:28:29.149Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:28:41.154Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:28:53.161Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:29:05.173Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:29:17.185Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:29:29.191Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:29:41.196Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:29:53.204Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:30:05.217Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:30:17.228Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:30:29.235Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:30:41.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:30:53.247Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:31:05.260Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:31:17.271Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:31:29.278Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:31:41.283Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:31:53.291Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:32:05.303Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:32:17.314Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:32:29.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:32:41.325Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:32:53.333Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:33:05.345Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:33:17.357Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:33:29.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:33:41.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:33:53.378Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:34:05.390Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:34:17.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:34:29.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:34:41.415Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:34:53.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:35:05.433Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:35:17.442Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:35:29.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:35:41.455Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:35:53.464Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:36:05.475Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:36:17.487Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:36:29.494Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:36:41.500Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:36:53.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:37:05.520Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:37:17.532Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:37:29.539Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:37:41.544Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:37:53.552Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:38:05.556Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:38:17.566Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:38:29.573Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:38:41.578Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:38:53.586Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:39:05.599Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:39:17.610Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:39:29.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:39:41.625Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:39:53.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:40:05.646Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:40:17.657Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:40:29.664Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:40:41.669Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:40:53.678Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:41:05.691Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:41:17.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:41:29.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:41:41.714Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:41:53.721Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:42:05.733Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:42:17.745Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:42:29.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:42:41.757Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:42:53.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:43:05.779Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:43:17.790Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:43:29.796Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:43:41.801Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:43:53.810Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:44:05.823Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:44:17.834Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:44:29.841Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:44:41.846Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:44:53.854Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:45:05.861Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:45:17.872Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:45:29.879Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:45:41.884Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:45:53.893Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:46:05.906Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:46:17.917Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:46:29.925Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:46:41.931Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:46:53.940Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:47:05.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:47:17.964Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:47:29.971Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:47:41.976Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:47:53.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:48:05.998Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:48:18.009Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:48:30.016Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:48:42.021Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:48:54.029Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:49:06.042Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:49:18.053Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:49:30.061Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:49:42.066Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:49:54.075Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:50:06.087Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:50:18.100Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:50:30.107Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:50:42.114Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:50:54.122Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:51:06.136Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:51:18.148Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:51:30.155Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:51:42.163Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:51:54.171Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:52:06.184Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:52:18.195Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:52:30.203Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:52:42.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:52:54.218Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:53:06.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:53:18.243Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:53:30.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:53:42.257Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:53:54.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:54:06.279Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:54:18.291Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:54:30.300Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:54:42.307Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:54:54.317Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:55:06.329Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:55:18.342Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:55:30.350Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:55:42.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:55:54.366Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:56:06.379Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:56:18.392Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:56:30.399Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:56:42.406Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:56:54.415Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:57:06.428Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:57:18.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:57:30.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:57:42.456Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:57:54.466Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:58:06.478Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:58:18.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:58:30.498Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:58:42.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:58:54.513Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:59:06.525Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:59:18.538Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:59:30.546Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T13:59:42.550Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T13:59:54.561Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:00:06.573Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:00:18.584Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:00:30.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:00:42.598Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:00:54.607Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:01:06.621Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:01:18.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:01:30.642Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:01:42.649Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:01:54.658Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:02:06.671Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:02:18.683Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:02:30.692Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:02:42.698Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:02:54.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:03:06.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:03:18.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:03:30.738Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:03:42.745Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:03:54.754Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:04:06.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:04:18.778Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:04:30.785Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:04:42.790Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:04:54.800Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:05:06.814Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:05:18.818Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:05:30.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:05:42.831Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:05:54.841Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:06:06.855Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:06:18.867Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:06:30.877Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:06:42.883Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:06:54.888Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:07:06.902Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:07:18.915Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:07:30.925Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:07:42.932Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:07:54.941Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:08:06.954Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:08:18.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:08:30.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:08:42.983Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:08:54.992Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:09:07.004Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:09:19.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:09:31.025Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:09:43.031Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:09:55.041Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:10:07.055Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:10:19.067Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:10:31.077Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:10:43.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:10:55.094Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:11:07.108Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:11:19.116Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:11:31.125Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:11:43.131Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:11:55.141Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:12:07.155Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:12:19.158Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:12:31.167Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:12:43.174Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:12:55.183Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:13:07.193Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:13:19.198Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:13:31.206Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:13:43.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:13:55.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:14:07.236Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:14:19.241Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:14:31.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:14:43.257Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:14:55.265Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:15:07.278Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:15:19.283Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:15:31.292Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:15:43.298Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:15:55.307Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:16:07.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:16:19.324Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:16:31.334Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:16:43.341Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:16:55.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:17:07.365Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:17:19.367Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:17:31.376Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:17:43.382Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:17:55.393Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:18:07.406Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:18:19.411Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:18:31.420Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:18:43.427Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:18:55.436Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:19:07.450Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:19:19.453Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:19:31.463Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:19:43.470Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:19:55.480Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:20:07.494Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:20:19.498Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:20:31.507Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:20:43.514Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:20:55.523Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:21:07.537Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:21:19.541Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:21:31.551Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:21:43.557Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:21:55.567Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:22:07.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:22:19.584Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:22:31.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:22:43.600Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:22:55.610Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:23:07.624Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:23:19.628Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:23:31.637Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:23:43.644Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:23:55.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:24:07.661Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:24:19.665Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:24:31.673Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:24:43.680Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:24:55.683Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:25:07.696Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:25:19.700Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:25:31.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:25:43.715Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:25:55.718Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:26:07.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:26:19.736Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:26:31.745Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:26:43.752Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:26:55.755Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:27:07.769Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:27:19.774Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:27:31.784Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:27:43.792Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:27:55.795Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:28:07.810Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:28:19.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:28:31.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:28:43.831Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:28:55.836Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:29:07.849Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:29:19.852Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:29:31.861Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:29:43.868Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:29:55.872Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:30:07.886Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:30:19.891Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:30:31.901Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:30:43.908Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:30:55.912Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:31:07.924Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:31:19.928Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:31:31.939Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:31:43.945Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:31:55.948Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:32:07.962Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:32:19.966Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:32:31.975Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:32:43.981Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:32:55.984Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:33:07.994Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:33:19.997Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:33:32.006Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:33:44.012Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:33:56.016Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:34:08.029Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:34:20.034Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:34:32.045Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:34:44.053Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:34:56.057Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:35:08.070Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:35:20.075Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:35:32.086Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:35:44.094Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:35:56.099Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:36:08.113Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:36:20.117Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:36:32.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:36:44.132Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:36:56.135Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:37:08.148Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:37:20.153Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:37:32.162Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:37:44.168Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:37:56.172Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:38:08.185Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:38:20.190Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:38:32.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:38:44.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:38:56.212Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:39:08.225Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:39:20.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:39:32.242Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:39:44.250Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:39:56.254Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:40:08.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:40:20.271Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:40:32.282Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:40:44.289Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:40:56.294Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:41:08.308Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:41:20.312Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:41:32.323Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:41:44.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:41:56.334Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:42:08.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:42:20.353Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:42:32.363Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:42:44.370Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:42:56.373Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:43:08.387Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:43:20.392Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:43:32.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:43:44.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:43:56.413Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:44:08.427Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:44:20.432Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:44:32.443Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:44:44.450Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:44:56.454Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:45:08.468Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:45:20.473Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:45:32.484Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:45:44.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:45:56.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:46:08.510Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:46:20.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:46:32.526Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:46:44.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:46:56.539Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:47:08.553Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:47:20.558Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:47:32.568Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:47:44.575Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:47:56.580Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:48:08.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:48:20.597Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:48:32.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:48:44.615Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:48:56.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:49:08.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:49:20.637Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:49:32.646Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:49:44.653Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:49:56.658Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:50:08.672Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:50:20.676Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:50:32.687Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:50:44.694Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:50:56.699Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:51:08.713Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:51:20.717Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:51:32.727Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:51:44.735Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:51:56.739Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:52:08.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:52:20.756Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:52:32.766Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:52:44.773Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:52:56.777Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:53:08.789Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:53:20.795Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:53:32.804Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:53:44.811Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:53:56.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:54:08.829Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:54:20.833Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:54:32.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:54:44.848Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:54:56.852Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:55:08.866Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:55:20.870Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:55:32.880Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:55:44.888Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:55:56.892Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:56:08.906Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:56:20.912Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:56:32.923Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:56:44.931Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:56:56.937Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:57:08.950Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:57:20.955Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:57:32.966Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:57:44.973Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:57:56.978Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:58:08.991Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:58:20.996Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:58:33.007Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:58:45.015Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:58:57.020Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:59:09.033Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:59:21.038Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:59:33.048Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T14:59:45.056Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T14:59:57.061Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:00:09.075Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:00:21.080Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:00:33.091Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:00:45.099Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:00:57.103Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:01:09.117Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:01:21.122Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:01:33.131Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:01:45.138Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:01:57.143Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:02:09.155Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:02:21.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:02:33.169Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:02:45.176Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:02:57.180Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:03:09.194Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:03:21.199Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:03:33.209Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:03:45.216Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:03:57.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:04:09.235Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:04:21.241Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:04:33.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:04:45.259Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:04:57.264Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:05:09.279Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:05:21.284Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:05:33.294Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:05:45.301Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:05:57.306Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:06:09.320Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:06:21.326Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:06:33.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:06:45.343Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:06:57.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:07:09.361Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:07:21.367Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:07:33.377Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:07:45.384Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:07:57.389Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:08:09.403Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:08:21.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:08:33.420Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:08:45.427Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:08:57.432Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:09:09.446Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:09:21.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:09:33.460Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:09:45.469Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:09:57.475Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:10:09.489Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:10:21.492Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:10:33.504Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:10:45.512Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:10:57.517Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:11:09.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:11:21.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:11:33.545Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:11:45.553Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:11:57.559Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:12:09.572Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:12:21.577Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:12:33.590Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:12:45.598Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:12:57.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:13:09.616Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:13:21.620Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:13:33.631Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:13:45.640Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:13:57.644Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:14:09.657Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:14:21.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:14:33.668Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:14:45.675Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:14:57.680Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:15:09.694Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:15:21.699Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:15:33.708Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:15:45.716Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:15:57.721Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:16:09.735Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:16:21.739Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:16:33.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:16:45.758Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:16:57.763Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:17:09.777Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:17:21.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:17:33.792Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:17:45.800Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:17:57.804Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:18:09.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:18:21.822Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:18:33.832Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:18:45.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:18:57.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:19:09.848Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:19:21.851Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:19:33.863Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:19:45.871Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:19:57.877Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:20:09.888Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:20:21.894Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:20:33.904Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:20:45.913Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:20:57.916Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:21:09.930Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:21:21.934Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:21:33.945Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:21:45.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:21:57.956Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:22:09.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:22:21.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:22:33.986Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:22:45.993Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:22:57.997Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:23:10.011Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:23:22.015Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:23:34.027Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:23:46.035Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:23:58.040Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:24:10.048Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:24:22.051Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:24:34.063Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:24:46.070Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:24:58.076Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:25:10.090Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:25:22.095Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:25:34.107Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:25:46.115Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:25:58.121Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:26:10.135Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:26:22.139Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:26:34.151Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:26:46.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:26:58.165Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:27:10.179Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:27:22.182Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:27:34.192Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:27:46.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:27:58.207Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:28:10.218Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:28:22.223Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:28:34.235Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:28:46.242Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:28:58.248Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:29:10.262Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:29:22.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:29:34.277Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:29:46.285Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:29:58.290Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:30:10.304Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:30:22.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:30:34.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:30:46.329Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:30:58.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:31:10.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:31:22.352Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:31:34.362Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:31:46.368Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:31:58.373Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:32:10.387Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:32:22.390Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:32:34.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:32:46.411Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:32:58.416Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:33:10.430Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:33:22.433Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:33:34.444Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:33:46.452Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:33:58.458Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:34:10.472Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:34:22.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:34:34.489Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:34:46.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:34:58.502Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:35:10.515Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:35:22.519Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:35:34.532Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:35:46.541Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:35:58.547Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:36:10.561Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:36:22.565Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:36:34.576Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:36:46.584Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:36:58.590Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:37:10.603Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:37:22.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:37:34.618Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:37:46.626Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:37:58.631Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:38:10.645Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:38:22.648Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:38:34.658Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:38:46.667Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:38:58.672Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:39:10.686Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:39:22.691Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:39:34.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:39:46.709Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:39:58.713Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:40:10.727Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:40:22.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:40:34.742Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:40:46.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:40:58.755Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:41:10.768Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:41:22.773Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:41:34.784Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:41:46.792Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:41:58.797Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:42:10.811Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:42:22.816Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:42:34.828Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:42:46.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:42:58.844Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:43:10.858Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:43:22.864Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:43:34.876Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:43:46.885Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:43:58.891Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:44:10.905Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:44:22.911Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:44:34.923Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:44:46.932Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:44:58.938Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:45:10.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:45:22.958Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:45:34.970Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:45:46.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:45:58.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:46:10.999Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:46:23.004Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:46:35.016Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:46:47.026Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:46:59.032Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:47:11.046Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:47:23.052Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:47:35.062Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:47:47.072Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:47:59.078Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:48:11.092Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:48:23.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:48:35.111Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:48:47.120Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:48:59.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:49:11.140Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:49:23.147Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:49:35.158Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:49:47.166Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:49:59.172Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:50:11.186Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:50:23.192Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:50:35.203Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:50:47.211Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:50:59.217Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:51:11.228Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:51:23.233Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:51:35.246Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:51:47.255Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:51:59.262Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:52:11.275Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:52:23.280Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:52:35.293Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:52:47.303Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:52:59.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:53:11.323Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:53:23.329Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:53:35.341Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:53:47.349Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:53:59.355Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:54:11.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:54:23.375Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:54:35.388Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:54:47.398Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:54:59.403Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:55:11.417Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:55:23.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:55:35.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:55:47.442Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:55:59.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:56:11.463Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:56:23.469Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:56:35.481Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:56:47.489Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:56:59.495Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:57:11.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:57:23.513Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:57:35.522Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T15:57:47.532Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:57:59.536Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:58:11.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:58:23.554Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:58:35.567Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:58:47.577Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:58:59.582Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:59:11.595Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:59:23.601Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:59:35.612Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:59:47.622Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T15:59:59.627Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:00:11.640Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:00:23.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:00:35.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:00:47.670Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:00:59.676Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:01:11.690Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:01:23.697Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:01:35.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:01:47.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:01:59.726Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:02:11.740Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:02:23.747Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:02:35.760Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:02:47.769Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:02:59.776Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:03:11.790Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:03:23.797Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:03:35.810Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:03:47.819Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:03:59.826Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:04:11.840Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:04:23.846Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:04:35.859Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:04:47.869Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:04:59.876Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:05:11.890Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:05:23.897Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:05:35.910Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:05:47.920Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:05:59.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:06:11.939Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:06:23.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:06:35.957Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:06:47.966Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:06:59.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:07:11.986Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:07:23.993Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:07:36.005Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:07:48.015Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:08:00.022Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:08:12.035Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:08:24.043Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:08:36.056Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:08:48.065Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:09:00.071Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:09:12.083Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:09:24.091Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:09:36.103Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:09:48.113Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:10:00.120Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:10:12.133Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:10:24.141Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:10:36.154Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:10:48.163Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:11:00.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:11:12.183Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:11:24.190Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:11:36.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:11:48.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:12:00.217Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:12:12.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:12:24.238Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:12:36.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:12:48.261Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:13:00.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:13:12.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:13:24.290Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:13:36.302Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:13:48.312Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:14:00.318Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:14:12.331Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:14:24.339Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:14:36.353Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:14:48.361Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:15:00.367Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:15:12.381Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:15:24.387Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:15:36.399Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:15:48.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:16:00.414Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:16:12.428Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:16:24.436Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:16:36.447Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:16:48.456Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:17:00.461Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:17:12.475Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:17:24.483Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:17:36.493Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:17:48.504Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:18:00.509Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:18:12.514Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:18:24.521Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:18:36.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:18:48.545Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:19:00.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:19:12.551Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:19:24.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:19:36.573Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:19:48.582Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:20:00.586Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:20:12.589Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:20:24.597Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:20:36.610Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:20:48.621Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:21:00.625Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:21:12.628Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:21:24.636Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:21:36.650Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:21:48.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:22:00.664Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:22:12.669Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:22:24.676Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:22:36.690Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:22:48.698Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:23:00.703Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:23:12.708Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:23:24.716Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:23:36.729Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:23:48.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:24:00.742Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:24:12.745Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:24:24.753Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:24:36.767Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:24:48.777Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:25:00.783Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:25:12.787Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:25:24.795Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:25:36.809Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:25:48.819Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:26:00.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:26:12.829Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:26:24.836Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:26:36.848Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:26:48.856Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:27:00.862Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:27:12.866Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:27:24.874Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:27:36.888Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:27:48.897Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:28:00.903Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:28:12.907Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:28:24.916Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:28:36.929Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:28:48.940Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:29:00.946Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:29:12.948Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:29:24.956Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:29:36.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:29:48.977Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:30:00.982Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:30:12.986Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:30:24.994Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:30:37.008Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:30:49.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:31:01.022Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:31:13.027Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:31:25.034Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:31:37.038Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:31:49.047Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:32:01.052Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:32:13.056Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:32:25.064Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:32:37.076Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:32:49.086Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:33:01.092Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:33:13.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:33:25.105Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:33:37.117Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:33:49.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:34:01.132Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:34:13.136Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:34:25.145Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:34:37.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:34:49.168Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:35:01.174Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:35:13.178Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:35:25.187Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:35:37.201Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:35:49.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:36:01.216Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:36:13.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:36:25.228Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:36:37.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:36:49.251Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:37:01.256Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:37:13.259Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:37:25.268Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:37:37.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:37:49.288Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:38:01.293Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:38:13.297Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:38:25.304Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:38:37.318Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:38:49.328Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:39:01.334Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:39:13.339Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:39:25.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:39:37.362Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:39:49.371Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:40:01.377Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:40:13.382Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:40:25.390Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:40:37.404Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:40:49.414Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:41:01.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:41:13.421Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:41:25.430Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:41:37.443Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:41:49.454Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:42:01.460Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:42:13.465Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:42:25.474Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:42:37.478Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:42:49.487Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:43:01.494Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:43:13.497Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:43:25.506Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:43:37.518Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:43:49.528Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:44:01.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:44:13.538Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:44:25.547Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:44:37.561Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:44:49.572Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:45:01.578Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:45:13.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:45:25.589Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:45:37.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:45:49.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:46:01.614Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:46:13.618Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:46:25.627Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:46:37.640Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:46:49.651Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:47:01.658Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:47:13.662Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:47:25.668Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:47:37.681Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:47:49.692Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:48:01.697Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:48:13.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:48:25.711Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:48:37.723Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:48:49.728Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:49:01.734Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:49:13.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:49:25.746Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:49:37.759Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:49:49.770Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:50:01.777Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:50:13.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:50:25.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:50:37.798Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:50:49.807Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:51:01.813Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:51:13.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:51:25.826Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:51:37.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:51:49.847Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:52:01.854Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:52:13.859Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:52:25.867Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:52:37.881Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:52:49.891Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:53:01.898Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:53:13.902Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:53:25.911Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:53:37.924Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:53:49.934Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:54:01.941Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:54:13.945Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:54:25.954Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:54:37.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:54:49.978Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:55:01.983Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:55:13.987Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:55:25.997Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:55:38.010Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:55:50.021Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:56:02.028Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:56:14.032Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:56:26.040Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:56:38.053Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:56:50.063Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:57:02.070Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:57:14.074Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:57:26.083Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:57:38.095Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:57:50.106Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:58:02.113Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:58:14.118Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:58:26.127Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:58:38.138Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T16:58:50.147Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:59:02.154Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:59:14.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:59:26.168Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:59:38.181Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T16:59:50.193Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:00:02.200Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:00:14.205Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:00:26.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:00:38.227Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:00:50.239Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:01:02.245Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:01:14.249Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:01:26.258Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:01:38.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:01:50.278Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:02:02.285Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:02:14.290Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:02:26.300Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:02:38.308Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:02:50.319Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:03:02.326Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:03:14.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:03:26.339Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:03:38.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:03:50.361Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:04:02.368Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:04:14.372Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:04:26.382Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:04:38.396Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:04:50.407Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:05:02.415Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:05:14.419Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:05:26.428Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:05:38.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:05:50.452Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:06:02.459Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:06:14.463Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:06:26.473Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:06:38.478Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:06:50.488Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:07:02.495Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:07:14.499Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:07:26.507Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:07:38.519Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:07:50.529Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:08:02.536Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:08:14.540Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:08:26.549Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:08:38.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:08:50.569Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:09:02.576Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:09:14.580Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:09:26.589Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:09:38.600Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:09:50.611Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:10:02.619Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:10:14.624Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:10:26.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:10:38.643Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:10:50.655Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:11:02.663Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:11:14.668Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:11:26.678Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:11:38.689Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:11:50.698Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:12:02.705Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:12:14.709Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:12:26.718Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:12:38.728Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:12:50.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:13:02.744Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:13:14.748Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:13:26.758Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:13:38.770Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:13:50.773Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:14:02.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:14:14.784Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:14:26.793Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:14:38.798Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:14:50.801Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:15:02.810Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:15:14.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:15:26.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:15:38.837Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:15:50.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:16:02.850Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:16:14.855Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:16:26.864Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:16:38.876Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:16:50.880Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:17:02.887Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:17:14.892Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:17:26.902Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:17:38.914Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:17:50.916Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:18:02.924Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:18:14.929Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:18:26.939Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:18:38.948Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:18:50.950Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:19:02.957Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:19:14.964Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:19:26.973Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:19:38.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:19:50.988Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:20:02.995Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:20:14.999Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:20:27.008Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:20:39.020Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:20:51.025Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:21:03.034Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:21:15.039Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:21:27.049Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:21:39.058Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:21:51.060Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:22:03.068Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:22:15.074Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:22:27.083Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T17:22:39.095Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:22:51.100Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:23:03.109Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:23:15.114Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:23:27.123Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:23:39.136Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:23:51.138Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:24:03.145Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:24:15.149Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:24:27.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:24:39.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:24:51.173Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:25:03.180Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:25:15.184Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:25:27.194Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:25:39.206Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:25:51.210Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:26:03.217Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:26:15.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:26:27.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:26:39.243Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:26:51.246Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:27:03.253Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:27:15.258Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:27:27.268Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:27:39.280Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:27:51.285Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:28:03.294Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:28:15.299Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:28:27.308Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:28:39.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:28:51.325Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:29:03.332Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:29:15.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:29:27.347Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:29:39.360Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:29:51.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:30:03.371Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:30:15.375Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:30:27.385Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:30:39.388Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:30:51.393Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:31:03.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:31:15.408Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:31:27.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:31:39.419Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:31:51.424Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:32:03.433Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:32:15.439Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:32:27.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:32:39.460Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:32:51.465Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:33:03.473Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:33:15.478Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:33:27.488Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:33:39.499Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:33:51.504Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:34:03.513Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:34:15.518Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:34:27.528Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:34:39.540Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:34:51.545Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:35:03.553Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:35:15.559Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:35:27.569Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:35:39.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:35:51.586Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:36:03.593Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:36:15.598Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:36:27.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:36:39.620Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:36:51.625Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:37:03.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:37:15.638Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:37:27.648Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:37:39.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:37:51.663Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:38:03.671Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:38:15.676Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:38:27.686Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:38:39.697Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:38:51.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:39:03.711Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:39:15.715Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:39:27.726Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:39:39.739Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:39:51.743Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:40:03.748Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:40:15.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:40:27.758Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:40:39.771Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:40:51.775Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:41:03.784Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:41:15.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:41:27.799Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:41:39.812Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:41:51.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:42:03.823Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:42:15.829Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:42:27.838Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:42:39.850Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:42:51.855Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:43:03.863Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:43:15.868Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:43:27.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:43:39.890Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:43:51.895Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:44:03.903Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:44:15.908Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:44:27.918Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:44:39.930Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:44:51.934Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:45:03.940Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:45:15.945Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:45:27.955Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:45:39.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:45:51.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:46:03.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:46:15.985Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:46:27.995Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:46:40.006Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:46:52.009Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:47:04.017Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:47:16.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:47:28.034Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:47:40.046Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:47:52.052Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:48:04.058Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:48:16.063Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:48:28.072Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:48:40.084Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:48:52.089Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:49:04.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:49:16.104Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:49:28.114Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:49:40.126Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:49:52.130Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:50:04.139Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:50:16.145Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:50:28.155Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:50:40.167Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:50:52.171Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:51:04.179Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:51:16.184Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:51:28.195Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:51:40.207Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:51:52.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:52:04.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:52:16.227Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:52:28.237Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:52:40.250Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:52:52.254Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:53:04.263Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:53:16.268Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:53:28.279Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:53:40.291Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:53:52.297Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:54:04.304Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:54:16.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:54:28.320Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:54:40.332Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:54:52.336Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:55:04.344Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:55:16.349Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:55:28.360Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:55:40.372Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:55:52.376Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:56:04.384Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:56:16.389Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:56:28.400Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:56:40.412Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:56:52.416Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:57:04.424Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:57:16.430Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:57:28.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:57:40.452Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:57:52.455Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:58:04.465Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:58:16.469Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:58:28.479Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:58:40.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:58:52.495Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:59:04.503Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:59:16.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:59:28.519Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:59:40.531Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T17:59:52.536Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:00:04.543Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:00:16.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:00:28.559Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:00:40.571Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:00:52.577Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:01:04.587Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:01:16.592Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:01:28.603Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:01:40.616Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:01:52.620Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:02:04.630Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:02:16.636Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:02:28.646Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:02:40.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:02:52.665Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:03:04.674Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:03:16.678Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:03:28.689Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:03:40.702Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:03:52.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:04:04.714Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:04:16.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:04:28.730Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:04:40.742Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:04:52.746Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:05:04.755Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:05:16.760Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:05:28.771Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:05:40.783Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:05:52.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:06:04.796Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:06:16.802Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:06:28.813Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:06:40.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:06:52.829Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:07:04.837Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:07:16.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:07:28.853Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:07:40.865Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:07:52.870Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:08:04.878Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:08:16.883Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:08:28.893Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:08:40.906Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:08:52.912Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:09:04.921Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:09:16.928Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:09:28.938Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:09:40.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:09:52.957Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:10:04.967Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:10:16.972Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:10:28.984Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:10:40.998Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:10:53.003Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:11:05.012Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:11:17.018Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:11:29.029Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:11:41.042Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:11:53.047Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:12:05.056Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:12:17.061Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:12:29.072Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:12:41.086Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:12:53.091Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:13:05.101Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:13:17.107Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:13:29.118Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:13:41.130Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:13:53.135Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:14:05.142Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:14:17.149Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:14:29.160Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:14:41.173Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:14:53.179Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:15:05.188Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:15:17.193Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:15:29.202Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:15:41.214Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:15:53.221Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:16:05.229Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:16:17.236Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:16:29.248Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:16:41.261Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:16:53.267Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:17:05.276Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:17:17.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:17:29.292Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:17:41.305Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:17:53.310Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:18:05.319Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:18:17.326Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:18:29.337Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:18:41.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:18:53.355Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:19:05.364Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:19:17.371Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:19:29.383Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:19:41.396Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:19:53.402Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:20:05.411Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:20:17.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:20:29.428Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:20:41.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:20:53.448Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:21:05.457Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:21:17.463Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:21:29.475Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:21:41.489Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:21:53.494Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:22:05.503Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:22:17.510Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:22:29.521Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:22:41.533Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:22:53.538Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:23:05.547Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:23:17.554Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:23:29.566Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:23:41.578Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:23:53.582Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:24:05.591Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:24:17.597Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:24:29.609Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:24:41.621Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:24:53.628Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:25:05.637Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:25:17.642Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:25:29.653Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:25:41.666Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:25:53.671Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:26:05.681Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:26:17.688Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:26:29.700Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:26:41.713Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:26:53.720Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:27:05.731Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:27:17.738Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:27:29.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:27:41.764Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:27:53.769Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:28:05.778Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:28:17.784Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:28:29.796Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:28:41.808Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:28:53.812Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:29:05.821Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:29:17.827Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:29:29.840Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:29:41.853Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:29:53.860Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:30:05.870Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:30:17.877Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:30:29.889Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:30:41.903Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:30:53.910Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:31:05.918Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:31:17.926Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:31:29.939Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:31:41.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:31:53.959Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:32:05.969Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:32:17.976Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:32:29.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:32:41.993Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:32:54.000Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:33:06.009Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:33:18.016Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:33:30.019Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:33:42.033Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:33:54.039Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:34:06.050Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:34:18.057Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:34:30.060Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:34:42.074Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:34:54.081Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:35:06.089Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:35:18.095Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:35:30.099Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:35:42.113Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:35:54.118Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:36:06.127Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:36:18.133Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:36:30.136Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:36:42.145Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:36:54.150Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:37:06.159Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:37:18.165Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:37:30.169Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:37:42.183Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:37:54.189Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:38:06.191Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:38:18.198Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:38:30.202Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:38:42.216Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:38:54.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:39:06.231Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:39:18.237Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:39:30.240Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:39:42.254Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:39:54.260Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:40:06.270Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:40:18.276Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:40:30.281Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:40:42.295Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:40:54.300Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:41:06.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:41:18.315Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:41:30.318Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:41:42.328Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:41:54.333Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:42:06.344Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:42:18.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:42:30.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:42:42.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:42:54.376Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:43:06.386Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:43:18.394Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:43:30.399Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:43:42.412Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:43:54.418Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:44:06.427Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:44:18.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:44:30.439Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:44:42.451Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:44:54.457Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:45:06.466Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:45:18.472Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:45:30.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:45:42.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:45:54.496Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:46:06.506Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:46:18.511Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:46:30.514Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:46:42.528Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:46:54.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:47:06.544Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:47:18.550Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:47:30.554Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:47:42.568Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:47:54.575Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:48:06.584Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:48:18.592Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:48:30.594Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:48:42.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:48:54.614Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:49:06.625Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:49:18.629Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:49:30.633Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:49:42.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:49:54.652Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:50:06.662Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:50:18.667Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:50:30.672Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:50:42.686Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:50:54.694Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:51:06.704Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:51:18.712Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:51:30.717Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:51:42.725Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T18:51:54.733Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:52:06.742Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:52:18.749Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:52:30.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:52:42.765Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:52:54.772Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:53:06.781Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:53:18.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:53:30.791Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:53:42.804Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:53:54.809Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:54:06.819Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:54:18.825Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:54:30.828Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:54:42.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:54:54.848Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:55:06.858Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:55:18.865Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:55:30.868Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:55:42.882Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:55:54.889Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:56:06.898Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:56:18.906Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:56:30.909Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:56:42.923Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:56:54.930Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:57:06.940Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:57:18.947Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:57:30.952Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:57:42.965Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:57:54.973Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:58:06.978Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:58:18.984Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:58:30.988Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:58:43.002Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:58:55.009Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:59:07.018Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:59:19.023Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:59:31.028Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:59:43.041Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T18:59:55.047Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:00:07.057Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:00:19.064Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:00:31.068Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:00:43.082Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:00:55.088Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:01:07.099Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:01:19.105Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:01:31.108Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:01:43.122Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:01:55.128Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:02:07.137Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:02:19.144Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:02:31.148Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:02:43.162Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:02:55.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:03:07.181Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:03:19.189Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:03:31.194Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:03:43.208Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:03:55.215Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:04:07.225Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:04:19.233Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:04:31.238Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:04:43.252Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:04:55.260Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:05:07.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:05:19.277Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:05:31.282Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:05:43.295Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:05:55.303Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:06:07.313Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:06:19.321Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:06:31.325Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:06:43.338Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:06:55.346Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:07:07.356Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:07:19.362Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:07:31.367Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:07:43.380Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:07:55.387Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:08:07.397Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:08:19.405Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:08:31.410Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:08:43.423Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:08:55.430Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:09:07.441Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:09:19.449Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:09:31.454Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:09:43.467Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:09:55.474Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:10:07.484Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:10:19.491Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:10:31.495Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:10:43.508Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:10:55.516Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:11:07.526Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:11:19.533Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:11:31.538Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:11:43.551Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:11:55.558Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:12:07.568Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:12:19.575Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:12:31.579Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:12:43.588Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T19:12:55.594Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:13:07.604Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:13:19.610Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:13:31.615Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:13:43.628Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:13:55.636Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:14:07.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:14:19.655Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:14:31.659Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:14:43.673Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:14:55.681Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:15:07.692Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:15:19.700Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:15:31.705Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:15:43.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:15:55.726Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:16:07.736Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:16:19.744Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:16:31.748Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:16:43.761Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:16:55.768Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:17:07.778Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:17:19.785Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:17:31.789Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:17:43.798Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T19:17:55.806Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:18:07.817Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:18:19.823Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:18:31.828Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:18:43.842Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:18:55.849Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:19:07.859Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:19:19.866Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:19:31.871Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:19:43.884Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:19:55.891Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:20:07.901Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:20:19.908Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:20:31.910Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:20:43.924Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:20:55.929Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:21:07.941Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:21:19.947Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:21:31.949Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:21:43.963Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:21:55.969Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:22:07.980Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:22:19.989Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:22:31.992Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:22:44.006Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:22:56.012Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:23:08.022Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:23:20.029Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:23:32.031Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:23:44.044Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:23:56.050Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:24:08.060Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:24:20.067Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:24:32.069Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:24:44.083Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:24:56.088Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:25:08.098Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:25:20.105Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:25:32.109Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:25:44.122Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:25:56.128Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:26:08.140Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:26:20.147Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:26:32.151Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:26:44.164Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:26:56.170Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:27:08.181Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:27:20.188Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:27:32.192Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:27:44.207Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:27:56.213Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:28:08.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:28:20.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:28:32.232Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:28:44.243Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T19:28:56.249Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:29:08.261Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:29:20.269Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:29:32.272Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:29:44.286Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:29:56.292Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:30:08.302Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:30:20.309Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:30:32.311Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:30:44.324Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:30:56.330Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:31:08.341Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:31:20.348Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:31:32.351Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:31:44.363Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T19:31:56.369Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:32:08.380Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:32:20.388Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:32:32.391Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:32:44.403Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T19:32:56.409Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:33:08.420Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:33:20.429Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:33:32.432Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:33:44.445Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:33:56.452Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:34:08.462Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:34:20.472Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:34:32.476Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:34:44.488Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:34:56.495Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:35:08.506Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:35:20.513Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:35:32.517Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:35:44.530Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:35:56.537Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:36:08.548Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:36:20.556Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:36:32.560Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:36:44.574Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:36:56.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:37:08.591Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:37:20.600Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:37:32.602Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:37:44.616Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:37:56.624Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:38:08.636Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:38:20.644Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:38:32.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:38:44.663Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:38:56.670Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:39:08.682Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:39:20.690Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:39:32.693Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:39:44.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:39:56.713Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:40:08.725Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:40:20.732Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:40:32.737Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:40:44.750Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:40:56.756Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:41:08.766Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:41:20.775Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:41:32.780Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:41:44.788Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:41:56.795Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:42:08.806Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:42:20.815Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:42:32.819Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T19:42:44.832Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:19:25.094Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:19:37.102Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:19:49.106Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:20:01.120Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:20:13.134Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T21:20:25.142Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:20:37.150Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:20:49.154Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:21:01.166Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:21:13.179Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T21:21:25.187Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:21:37.195Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:21:49.199Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:22:01.211Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:22:13.222Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:22:25.230Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:22:37.237Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:22:49.242Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:23:01.250Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T21:23:13.263Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:23:25.271Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:23:37.279Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:23:49.283Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:24:01.292Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:24:13.305Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:24:25.314Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:24:37.322Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:24:49.327Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:25:01.332Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:25:13.342Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:25:25.350Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:25:37.358Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:25:49.361Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:26:01.372Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:26:13.386Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:26:25.392Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:26:37.401Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:26:49.405Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:27:01.412Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:27:13.426Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T21:27:25.434Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:27:37.442Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:27:49.446Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:28:01.457Z] [WARN] [Redis] Connection error: getaddrinfo EAI_AGAIN redis
[2025-09-29T21:28:13.462Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:28:25.470Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:28:37.477Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:28:49.481Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:29:01.493Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:29:13.502Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:29:25.510Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:29:37.517Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:29:49.521Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:30:01.534Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:30:13.546Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:30:25.555Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:30:37.563Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:30:49.568Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:31:01.581Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:31:13.592Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:31:25.601Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:31:37.608Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:31:49.614Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:32:01.627Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:32:13.638Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:32:25.647Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:32:37.652Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:32:49.656Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:33:01.669Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:33:13.682Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:33:25.691Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:33:37.700Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:33:49.706Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:34:01.719Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:34:13.730Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:34:25.738Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:34:37.746Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:34:49.751Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:35:01.765Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:35:13.778Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T21:35:25.789Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
[2025-09-29T23:19:07.713Z] [WARN] [Redis] Connection error: connect ETIMEDOUT
